\documentclass[10pt,a4paper]{book}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{hyperref}
\usepackage[francais]{babel}
\usepackage{hyperref}
\usepackage{amssymb,amsthm,amsmath,amsfonts}
\usepackage{algorithmic}
\usepackage{algorithm}
\usepackage{units}
\usepackage{lmodern}
\usepackage{fp}
\usepackage{graphicx}
\bibliographystyle{plain}
\usepackage{epsfig}
\usepackage{epstopdf}
\usepackage{makeidx}
\usepackage{gloss}
\usepackage{xcolor}
\def\glossname{Glossaire}
\usepackage{ragged2e}
\usepackage{changepage}
\usepackage{tikz}
\usetikzlibrary{calc}
\usetikzlibrary{fixedpointarithmetic}

\usepackage{fancyhdr}
\pagestyle{fancy}




\theoremstyle{plain}
\newtheorem{thm}{Théorème}
\theoremstyle{definition} 
\newtheorem{lem}[thm]{Lemme}
\theoremstyle{definition} 
\newtheorem{cor}[thm]{Corollaire}
\theoremstyle{definition} 
\newtheorem{prop}[thm]{Proposition}
\theoremstyle{definition} 
\newtheorem{defi}[thm]{Définition}
\theoremstyle{remark} 
\newtheorem{rem}[thm]{Remarque}
\theoremstyle{remark} 
\newtheorem{exe}[thm]{Exemple}

\def\algorithmicrequire{\textbf{Entrée:}}
\def\algorithmicensure{\textbf{Sortie:}}

\newcommand{\defeq}{\mathrel{\mathop:}=}

\author{Hugounenq Cyril}
\title{Arithmétique Rapide appliqué à la Géométrie et à la Cryptologie}
\makeindex
\makegloss


\makeatletter
\def\footrule{{
\vskip-\footruleskip\vskip-\footrulewidth
\color{\footrulecolor}
\hrule\@width\headwidth\@height
\footrulewidth\vskip\footruleskip
}}
\makeatother

%%% BEGIN DOCUMENT
\begin{document}
\fancyhf{}%␣efface␣tout␣ce␣qu'il␣y␣avait␣avant
\fancyhead[L]{\nouppercase\leftmark}%␣LO␣=␣gauche/impair␣;␣RE␣=␣droite/pair
\fancyhead[R]{}
\fancyfoot[C]{\thepage}%␣C␣=␣centré
\fancyfoot[L]{}




\renewcommand{\headrulewidth}{1pt}% 1pt header rule
\renewcommand{\headrule}{\hbox to\headwidth{%
  \color{orange}\leaders\hrule height \headrulewidth\hfill}}
  
\renewcommand{\footrulewidth}{1pt}% 1pt header rule
\newcommand{\footrulecolor}{blue}


%\small
\setlength{\parskip}{-1pt plus 1pt}

\newcommand{\abstracttextfont}{\normalfont}
%\abstractintoc
%\begin{abstract} 
%Text 
%\end{abstract}
%\abstractintoc
%\renewcommand\abstractname{R\'esum\'e}
%\begin{abstract} \selectlanguage{french}
%Texte 
%\end{abstract}
\selectlanguage{french}% french si rapport en français



%\cleardoublepage

%\tableofcontents* % the asterisk means that the table of contents itself isn't put into the ToC
\normalsize

\mainmatter
% \SingleSpace

\chapter{Rappels théoriques}
\label{cha:Rappels theoriques}


\section{Théorie des ordres dans un corps quadratique imaginaire}

\section{Courbes Elliptiques}

Dans ce chaptire nous allons faire quelques rappels sur les courbes elliptiques. Pour approfondir le sujet le lecteur pourra consulter \cite{Silv1} ou encore \cite{Washington2008}

\subsection{\'Equations de Weierstrass}

Soit $\mathbb{K}$ un corps, on dénote par $\overline{\mathbb{K}}$ sa cloture algébrique. Sauf indication explicite contraire par convention on notera $p$ la caractérisitque du corps $\mathbb{K}$. On rappelle tout d'abord  la définition d'un espace projectif sur $\mathbb{K}$.

\begin{defi}
On appelle espace projectif de dimension $2$ sur un corps $\mathbb{K}$ et on note $\mathbb{P}^2(\mathbb{K})$, l'ensemble des classes $(X:Y:Z)$ de la relation d'équivalence définie comme suit:
\begin{equation*}
\forall (X,Y,Z) \in \mathbb{K}^3 \setminus (0,0,0), (X,Y,Z) \equiv (X',Y',Z') \textit{ ssi }\exists c \in \mathbb{K}^*, X'=cX, Y'=cY, Z'=cZ.
\end{equation*}
\end{defi}

\begin{defi}
Une courbe elliptique $E$ peut être définie comme la variété projective associée à l'équation
\begin{equation}
\label{eq:weierstrass-proj}
E:Y^2Z+a_1XYZ+a_3YZ^2=X^3+a_2X^2Z+a_4XZ^2+a_6Z^3
\end{equation}
avec $a_1,a_2,a_3,a_4,a_6$ des éléments de $\overline{\mathbb{K}}$. Le point $[0:1:0]$ est appelé le \emph{point à l'infini} et sera noté $O_E$. Dès lors que $a_1,a_2,a_3,a_4,a_6$ appartiennent à $\mathbb{K}$ alors la courbe est dite définie sur $\mathbb{K}$.
\end{defi}

L'équation \eqref{eq:weierstrass-proj} est dite forme homogène de l'équation de Weierstrass. En appliquant le changement de variables $x=\frac{X}{Z}$, $y=\frac{Y}{Z}$, on passe alors en coordonnées affines et on obtient l'équation de Weierstrass suivante:

\begin{equation}
\label{eq:weierstrass-red}
E:y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6
\end{equation}
appelée équation affine de Weierstrass. La courbe $E$ est alors définie comme étant l'ensemble des points solutions de \eqref{eq:weierstrass-red} avec le point à l'infini $O_E$.

 On définit aussi:
\begin{equation*}
b_2=a_1^2+4a_2, b_4=a_1a_3+2a_4, b_6=a_3^2+4a_6, b_8=a_1^2a_6-a_1a_3a_4+4a_2a_6+a_2a_3^2-a_2^4
\end{equation*}
\'A l'aide de ceux-ci on défnit le discriminant $\Delta$ de l'équation de Weierstrass \ref{eq:weierstrass-red}:
\begin{equation*}
\Delta = -b_2^2b_8-8b_4-27b_6^2+9b_2b_4b_6
\end{equation*}

La courbe $E$ admet un unique point singulier si et seulement si $\Delta$ est nul, la courbe est non singulière si et seulement si $\Delta$ est non nul (\cite[Prop. III.1.4]{Silv1}).

%L'équation de Weierstrass \ref{eq:weierstrass} est dite non-singulière si et seulement si $\Delta$ est non nul.
%On peut alors énoncer une autre définition de courbe elliptique.

%\begin{defi}
%Une courbe elliptique $E$ sur $\mathbb{K}$ est une courbe définie par une équation de Weierstrass \ref{eq:weierstrass-red} non singulière.
%\end{defi}

On définit: 
\begin{equation*}
j=\frac{(b_2^2-24b_4)^3}{\Delta}
\end{equation*}
La constante $j$ est appelée \emph{$j$-invariant} de la courbe.

Une question naturelle est de se demander à quel point l'équation de Weierstrass définit de façon unique une courbe elliptique. En considèrant les changements de variable qui préservent le point à l'infini $O_E$, il est montré \cite[III.3.1b]{Silv1} que le seul changement de variable préservant la forme de l'équation de Weierstrass et $O_E$ est:

\begin{equation*}
x=u^2x'+r    \quad  y=u^3y'+u^2sx'+t
\end{equation*}
avec $u,r,s,t$ des éléments de $\overline{\mathbb{K}}$ et $u$ différent de $0$. En calculant alors les coefficients $a'_i$ de la nouvelle équation de Weierstrass obtenu par le changement de variables, on obtient un $j$-invariant identique ce qui justifie alors la dénomination de celui-ci.
\newline


\begin{defi}
Soit une courbe $E$ définie sur $\mathbb{K}$ on définit $E(\mathbb{K})$, l'ensemble des points d'une courbe elliptique $E$ défini sur $\mathbb{K}$, comme étant l'ensemble:
\begin{equation*}
E(\mathbb{K})=\{(X:Y:Z)\in \mathbb{P}^2(\mathbb{K}) \setminus (0,0,0) : Y^2Z+a_1XYZ+a_3YZ^2=X^3+a_2X^2Z+a_4XZ^2+a_6Z^3 \}
\end{equation*}
Le seul point correspondant à $Z=0$ est le point à l'infini $O_E=(0:1:0)$, chaque classe différente de $O_E$ a un unique représentant $(X:Y:1)$ ce qui nous donne la notation équivalente suivante:
\begin{equation*}
E(\mathbb{K})=\{(x,y)\in \mathbb{K}^2  : y^2+a_1xy+a_3y=x^3+a_2x^2+a_4x+a_6 \} \cup {O_E}
\end{equation*}
\end{defi}

On rappelle que si l'on note $f(x,y)=0$ l'équation affine de Weierstrass d'une courbe elliptique $E$ définie sur $\mathbb{K}$, alors son corps de fonction $\mathbb{K}(E)$ est le corps des fractions de l'anneau des coordonnées:
\begin{equation*}
\mathbb{K}[x,y]/(f(x,y)).
\end{equation*}

\subsection{Loi de groupe}
%\begin{figure}
%\begin{tikzpicture}[domain=-10/3:4.5,samples=100,yscale=1/2]
%\begin{scope}[fixed point arithmetic]
%\coordinate (Q) at (2, -4/3) {};
%\coordinate (-Q) at (2, 4/3) {};
%\coordinate (-2Q) at (-1079/576, 59653/13824);
%\coordinate (3Q) at (2319138/4977361, 27920423524/11104492391);
%\draw plot (\x,{sqrt(\x*\x*\x+(3-100/9)*\x+10)});
%\draw plot (\x,{-sqrt(\x*\x*\x+(3-100/9)*\x+10)});
%\draw (-2Q) node[/dot,label=$P$] {}
%              (3Q) node[/dot,label=$Q$] (G) {}
%              (-Q) node[/dot,label=$R$] {};
%\draw[label position=right,label distance=5pt] (Q) node[/dot,label=$P+Q$] {};
%\end{scope}
%\end{tikzpicture}
%\end{figure}
%
\begin{figure}
\begin{center}

\begin{tikzpicture}[scale=0.60,domain=-10/3:4.5,samples=100,yscale=1/2]
          \begin{scope}[fixed point arithmetic]
            \begin{scope}[fixed point arithmetic]
              \coordinate (Q) at (2, -4/3) {};
              \coordinate (-Q) at (2, 4/3) {};
              \coordinate (-2Q) at (-1079/576, 59653/13824);
              \coordinate (3Q) at (2319138/4977361, 27920423524/11104492391);
            \end{scope}

            \draw plot (\x,{sqrt(\x*\x*\x+(3-100/9)*\x+10)});
            \draw plot (\x,{-sqrt(\x*\x*\x+(3-100/9)*\x+10)});

            \draw[shorten >=-2cm, shorten <=-2cm] (-2Q) -- (-Q);
            \draw[dashed] (-Q) -- (Q);

            \begin{scope}[/dot/.style={draw,circle,inner sep=1pt,fill},
              every label/.style={inner sep=5pt,font=\scriptsize}]
              \draw (-2Q) node[/dot,label=$P$] {}
               (3Q) node[/dot,label=$Q$] (G) {}
              (-Q) node[/dot,label=$R$] {};
              \draw[label position=right,label distance=5pt] (Q) node[/dot,label=$P+Q$] {};
            \end{scope}
          \end{scope}

%          \begin{scope}[xshift=10cm,fixed point arithmetic]
%            \draw plot (\x,{sqrt(\x*\x*\x+(3-100/9)*\x+10)});
%            \draw plot (\x,{-sqrt(\x*\x*\x+(3-100/9)*\x+10)});
%
%            \begin{scope}[fixed point arithmetic]
%              \coordinate (-Q) at (2, 4/3) {};
%              \coordinate (-2Q) at (-1079/576, 59653/13824);
%              \path let \p1 = (-2Q) in coordinate (2Q) at (\x1,-\y1);
%            \end{scope}
%
%            \draw[shorten >=-2cm, shorten <=-2cm] (-Q) -- (2Q);
%            \draw[dashed] (-2Q) -- (2Q);
%
%            \begin{scope}[/dot/.style={draw,circle,inner sep=1pt,fill},
%              every label/.style={inner sep=5pt,font=\scriptsize}]
%              \draw (-Q) node[/dot,label=$P$] {}
%              (-2Q) node[/dot,label=$[2]P$] (G) {};
%              \draw[label position=below] (2Q) node[/dot,label=$R$] {};
%            \end{scope}
%          \end{scope}
        \end{tikzpicture}

\end{center}
\end{figure}

On peut définir sur $E(\mathbb{K})$ une loi de groupe abélienne à l'aide de la méthode dite de la \emph{corde et de la tangente}

\begin{defi}[Loi d'addition]
Soient $P,Q \in E(\mathbb{K})$, $L$ la droite reliant $P$ à $Q$ (ou tangente si $P=Q$) et $R$ le troisième point d'intersection de $L$ avec $E$. Soit $L'$ la droite reliant $R$ à $O_E$ cette droite intersecte alors la courbe en un troisième point $P+Q$.
\end{defi}

Une preuve que cette loi définit bien une loi de groupe abélienne est montrée dans \cite[III.2.2]{Silv1}.

En utilisant la notation $(x_P,y_P)$ pour les coordonnées affines d'un point $P$ de la courbe, on obtient alors pour des points $P,Q$ de $E(\mathbb{K})$ les formules suivantes:
\begin{itemize}
\item $P+O_E=O_E+P=(x_P,y_P)$
\item $-P=(x_P,-y_P-a_1x_P-a_3)$
\item En notant $\lambda= \begin{cases}
\frac{y_{Q}-y_{P}}{x_{Q}-x_{P}} & \textit{si } P\neq Q\\
\frac{3x_{P}^{2}+2a_{2}x_{P}+a_{4}-a_{1}y_{P}}{2y_{P}+a_{1}x_{P}+a_{3}} & \textit{si } P=Q
\end{cases}\ $,

on peut alors exprimer les coordonnées de $P+Q$:
\begin{equation*}
\begin{alignedat}{1}
& x_{P+Q}=\lambda^2 +a_1\lambda-a_2-x_P-x_Q,\\
& y_{P+Q}=-(\lambda +a_1)x_{P+Q}-y_{P}-\lambda x_P-a_3
\end{alignedat}
\end{equation*}
\end{itemize}




\paragraph*{Multiplication scalaire}\   {
\newline


\'A l'aide de la loi additive on peut définir la multiplication scalaire par l'entier naturel $m$ comme suit:

\begin{equation}
\begin{alignedat}{1}
[m]: E(\mathbb{K}) & \rightarrow E(\mathbb{K}) \\
P & \mapsto \underbrace{P+ \cdots +P}_{m fois} 
\end{alignedat}
\end{equation}

\begin{defi}
On appelle points de \emph{$m$-torsion} l'ensemble des points de $E$ qui sont envoyés sur l'élément neutre $0_E$ par $[m]$. Cet ensemble est noté $E[m]$.
\end{defi}
%On a ici un exemple d'endomorphismes de la courbe $E$.
}

\subsection{Isogénies}

\begin{defi}
Soient $E_1$ et $E_2$ deux courbes elliptiques, une isogénie $\varphi$ de $E_1$ dans $E_2$ est un morphisme de groupes surjectif et de noyau fini noté:
\begin{equation*}
\varphi:E_1 \rightarrow E_2
\end{equation*}
En particulier on a $\varphi(O_{E_1})=O_{E_2}$.
\end{defi}
On dira que $E_1$ et $E_2$ sont isogènes si il existe une isogénie $\varphi$ qui va de $E_1$ dans $E_2$. 

\begin{exe}
La multiplication par $m$ est par exemple une isogénie:
\begin{equation*}
[m](P+Q)=[m]P+[m]Q
\end{equation*}
\end{exe}

Pour une isogénie $\varphi$ on peut définir sur les corps de fonctions associés à $E_1$ et $E_2$ l'injection suivante:
\begin{equation*}
\begin{alignedat}{1}
\varphi^*: \mathbb{K}(E_2) & \rightarrow \mathbb{K}(E_1) \\
f & \mapsto f  \circ \varphi
\end{alignedat}
\end{equation*}

\begin{defi}
Soit $\mathbb{K}$ un corps algébriquement clos, $\varphi$ une isogénie définie sur $\mathbb{K}$ qui va de $E_1$ dans $E_2$, alors $\varphi$ est dite \emph{séparable} ou \emph{inséparable} selon le fait que l'extension $[\mathbb{K}(E_1):\varphi^*(\mathbb{K}(E_2))]$ l'est ou pas. On note alors \emph{$\deg_s{\varphi}$}, \emph{$\deg_i{\varphi}$} les degrés de séparabilité et d'inséparabilité de l'extension de corps $[\mathbb{K}(E_1):\varphi^*(\mathbb{K}(E_2))]$ et l'on a $\deg{\varphi}=\deg_s{\varphi}\deg_i{\varphi}$ qui est égal aussi au degré de l'extension de corps $[\mathbb{K}(E_1):\varphi^*(\mathbb{K}(E_2))]$.
\end{defi}


Une isogénie de degré $\ell$ sera alors appelée: $\ell$-isogénie.

\begin{thm}
Soit $\varphi$ une isogénie de $E_1$ dans $E_2$, alors:
\begin{itemize}
\item pour tout point $Q$ de $E_2$ on a $|\varphi^{-1}(Q)|=\deg_s(\varphi)$,
\item si $\varphi$ est séparable alors $\deg_s(\varphi)=\deg(\varphi)=|\ker(\varphi)|$.
\end{itemize}
\end{thm}

\begin{proof}
Voir \cite[III.4.10]{Silv1}
\end{proof}

Comme les isogénies peuvent être décomposées de façon unique en un produit d'isogénie inséparable et séparable, alors on va se concentrer à la détermination d'isogénies séparables par la suite.

Voyons maintenant plus en détail le lien entre une isogénie séparable et son noyau, pour cela on va d'abord rappeler les formules de Vélu et une application de celle-ci.

\subsubsection{Formules de Vélu}

Pour un sous-groupe $C$ de $E(\mathbb{K})$ les formules de Vélu \cite{velu1971} permettent d'exprimer de façon canonique une isogénie séparable $E \rightarrow E'$ de noyau $C$ et de codomaine $E'$.  L'isogénie est $\mathbb{K}$-rationnelle si et seulement si le polynôme qui s'annule sur les abscisses des points du noyau $C$ est défini dans $\mathbb{K}[X]$.

Soit $P$ un point de $E$ alors les formules de Vélu nous donnent l'isogénie $I$ de noyau $C$ par: 
\begin{equation}
\label{eq:Velu}
I(P)= \left( x(P)+\sum_{Q \in C \setminus \{0_E\}} x(P+Q)-x(Q),y(P)+\sum_{Q \in C \setminus \{0_E\}} y(P+Q)-y(Q) \right)
\end{equation} 
On peut alors exprimer l'équation de la courbe codomaine de l'isogénie à l'aide des formules d'addition. Par un souci de simplicité on va se restreindre au cas où l'on a $p \neq 2$, dans ce cas là on peut exprimer l'équation de $E$ par:
\begin{equation*}
y^2=x^3+a_2 x^2 + a_4 x + a_6
\end{equation*}
On note alors par $f$ et $f'$ les deux fonctions suivantes dans $\mathbb{K}(E)$:
\begin{align*}
f(P)&=& x(P)^3+a_2x(P)^2+a_4x(P)+a_6 \\
f'(P)&=& 3x(P)^2+2a_2x(P)+a_4
\end{align*}
Avec les formules d'addition on peut réécrire l'équation \ref{eq:Velu} de la façon suivante en explicitant l'isogénie sur les coordonnées affines $x,y$ de chaque point de la courbe:
\begin{equation} \label{eq:velu:sum}
I(x,y)=\left( x + \sum_{Q \in G \setminus \{0_E\}} \frac{f'(Q)}{x-x(Q)}+\frac{2f(Q)}{(x-x(Q))^2} , y + \sum_{Q \in G \setminus \{0_E\}} -\frac{yf'(Q)}{(x-x(Q))^2}-\frac{4yf(Q)}{(x-x(Q))^3}  \right)
\end{equation}
Alors si on note: 
\begin{equation*}
h(x)=\prod_{Q \in G \setminus \{0_E\}}(x-x(Q)),
\end{equation*}
on obtient:
\begin{equation} 
\label{eq:velu:gh}
I(x,y)=\left(\frac{g(x)}{h(x)},y\left( \frac{g(x)}{h(x)} \right)'\right)
\end{equation}
avec $g$ un polynôme. On pose ensuite:
\begin{equation*}
t= \sum_{Q \in G \setminus \{0_E\}} f'(Q) \quad u=\sum_{Q \in G \setminus \{0_E\}} 2f(Q) \quad w=u+\sum_{Q \in G \setminus \{0_E\}}x(Q)f'(Q) 
\end{equation*}

\begin{rem}
On peut calculer l'isogénie à l'aide de la connaissance de son noyau. Une méthode pratique reste celle préconisé par Elkies \cite{elkies1998} \textcolor{red}{ref a mettre} qui utilise les équations \eqref{eq:velu:gh} et \eqref{eq:velu:sum}:
\begin{equation*}
\frac{g(x)}{h(x)}= x + \sum_{Q \in G \setminus \{0_E\}} \frac{f'(Q)}{x-x(Q)}+\frac{2f(Q)}{(x-x(Q))^2}
\end{equation*}
ce que l'on peut reformuler par:
\begin{equation}
\frac{g(x)}{h(x)}= \deg(I) x -p_1 - f'(x) \frac{h'(x)}{h(x)} -2f(x)  \left(\frac{h'(x)}{h(x)}\right)'
\end{equation}
avec $p_1$ la somme des abscisses des points du noyau. Ainsi à partir de $h(x)$ on est capable de calculer l'isogénie en $\mathsf{M}(\deg(I))$ opérations sur $\mathbb{K}$.
\end{rem}

Une conséquence directe de cette remarque est le résultat suivant.

\begin{cor}
Soit $E$ une courbe elliptique, alors il y a une correspondance bijective entre les isogénies séparables qui ont pour domaine de définition $E$ et les sous-groupes finis de $E$:
\begin{equation*}
\begin{alignedat}{1}
(\varphi :E\rightarrow \varphi(E)) &\mapsto  \ker(\varphi)  \\
 (E\rightarrow\nicefrac{E}{C})  &\  \reflectbox{$\mapsto$} \ C 
\end{alignedat}
\end{equation*}
\end{cor}

\begin{rem}
Pour $E$ une courbe elliptique et $C$ un sous-groupe fini des points de $E$ la notation $\nicefrac{E}{C}$ désigne la courbe obtenue par l'isogénie séparable de noyau $C$.
\end{rem}

L'ensemble des isogénies de $E_1$ vers $E_2$ adjoint à l'application nulle est appelé groupe des homomorphismes et est noté \emph{$\mathrm{Hom}(E_1,E_2)$}. L'ensemble des isogénies de $E_1$ vers $E_1$ adjoint à l'application nulle est appelé anneau des endomorphismes et est noté \emph{$\mathrm{End}(E_1)=\mathrm{Hom}(E_1,E_1)$}, les éléments de $\mathrm{End}(E_1)$ inversibles sont appelés automorphismes et sont notés \emph{$\mathrm{Aut}(E_1)$}. Une isogénie définie sur $\mathbb{K}$ sera dite \emph{$\mathbb{K}$-rationnelle} ou simplement \emph{rationnelle} quand il n'y a pas d'ambiguïtés.

\begin{thm}[Isogénie duale]
Soit $\varphi$ une isogénie définie sur $\mathbb{K}$ d'une courbe elliptique $E_1$ vers une courbe elliptique $E_2$, alors l'unique isogénie $\widehat{\varphi}$ qui va de $E_2$ ver $E_1$ telle que $\widehat{\varphi}\circ\varphi=[\deg(\varphi)]_{E_1}$ est appelée \emph{isogénie duale}.
\end{thm}

\begin{proof}
Voir \cite[III.6.1]{Silv1}
\end{proof}

\begin{thm}
Soit $\varphi:E_1 \rightarrow E_2$ une isogénie.
\begin{enumerate}
\item Soit $\lambda:E_2 \rightarrow E_3$ une autre isogénie, alors
\begin{equation*}
\widehat{\lambda \circ \varphi}= \widehat{\varphi} \circ \widehat{\lambda}.
\end{equation*} 
\item Soit $\phi:E_1 \rightarrow E_2$ une autre isogénie, alors
\begin{equation*}
\widehat{\varphi+\phi}=\widehat{\varphi}+\widehat{\phi}.
\end{equation*}
\item Pour tout $m$ entier relatif,
\begin{equation*}
[\widehat{m}]=[m] \textit{ et } \deg[m]=m^2.
\end{equation*}

\item $\deg( \varphi)=\deg(\widehat{\varphi})$,
\item $\widehat{\widehat{\varphi}}=\varphi$.
\end{enumerate}
 
\end{thm}

\begin{proof}
Voir \cite[Theorem III.6.2]{Silv1}.
\end{proof}

\begin{cor}
Soit $E$ une courbe elliptique définie sur $\mathbb{K}$ et $m \in \mathbb{Z}^*$,
\begin{enumerate}
\item Si $m \neq \mathrm{car}(\mathbb{K})$ alors
\begin{equation*}
E[m]=\nicefrac{\mathbb{Z}}{m\mathbb{Z}} \times \nicefrac{\mathbb{Z}}{m\mathbb{Z}}. 
\end{equation*}
\item Si $\mathrm{car}(\mathbb{K})=p>0$ alors:
\begin{equation*}
\begin{alignedat}{1}
&\textit{Soit } E[p^e]=\{O_E\} \textit{ pour tout } e \geqslant 1 \textit{alors $E$ est dite supersingulière }\\
&\textit{Soit } E[p^e]=\nicefrac{\mathbb{Z}}{p^e\mathbb{Z}} \textit{ pour tout } e \geqslant 1
\textit{alors $E$ est dite ordinaire }\end{alignedat}
\end{equation*}
\end{enumerate}
\end{cor}

\begin{proof}
Voir \cite[Corrolary III.6.4]{Silv1}.
\end{proof}

\begin{defi}
Une courbe elliptique $E$ définie sur un corps $\mathbb{K}$ de caractéristique $p$ différente de $0$ est dite \emph{supersingulière} si $E[p^e]=\{O_E\}$ pour tout $e$ entier naturel non nul, elle est dite \emph{ordinaire} sinon. 
\end{defi}

\begin{defi}[Module de Tate]
Soit $E$ une courbe elliptique et $\ell$ un nombre premier. Le \emph{module de Tate $\ell$-adique} de $E$ est le groupe:
\begin{equation*}
T_{\ell}(E)=\varprojlim_nE[\ell^n],
\end{equation*}
la limite projective étant définie par rapport à l'application naturelle
\begin{equation*}
E[\ell^{n+1}] \overset{[\ell]}{\rightarrow} E[\ell^n].
\end{equation*}
\end{defi}
Comme chacun des $E[\ell^n]$ est un $\nicefrac{\mathbb{Z}}{\ell^n\mathbb{Z}}$-module, on observe alors que le module de Tate a une structure naturelle de $\mathbb{Z}_{\ell}$-module.
\begin{prop}
En tant que $\mathbb{Z}_{\ell}$ module, le module de Tate a la structure suivante:
\begin{equation*}
T_{\ell} \cong 
\begin{cases} 
\mathbb{Z}_{\ell} \times \mathbb{Z}_{\ell} &\textit{ si } \ell \neq \mathrm{car}(\mathbb{K}). \\
\mathbb{Z}_{\ell} &\textit{ si } \ell=\mathrm{car}(\mathbb{K})  \textit{et E est ordinaire}. \\
\{O_E\} &\textit{ si } \ell=\mathrm{car}(\mathbb{K})  \textit{et E est supersingulière}.
\end{cases}
\end{equation*}
\end{prop}

%\begin{alignedat}{2}
%& T_{\ell} \cong \mathbb{Z}_{\ell} \times \mathbb{Z}_{\ell} &\textit{ si } \ell \neq \mathrm{car}(\mathbb{K}).& \\
%& T_{p} \cong \{O_E\} \textit{ or } \mathbb{Z}_{p} \times \mathbb{Z}_{\ell} &\textit{ si }  p =\mathrm{car}(\mathbb{K})&>0.
%\end{alignedat}


\subsection{Endomorphismes}

Soit $E$ une courbe elliptique, alors si l'on adjoint à $\mathrm{End}(E)=\mathcal{O}$, la composition et l'addition d'endomorphismes cela forme un anneau. De plus la multiplication scalaire fournit une injection de $\mathbb{Z}$ dans $\mathrm{End}(E)$. Cependant $\mathrm{End}(E)$ n'est pas nécessairement réduit à $\mathbb{Z}$.

\begin{defi}
Une courbe elliptique $E$ est dite à multiplication complexe si $\mathrm{End}(E)$ n'est pas réduit à $\mathbb{Z}$.
\end{defi}
On a le résultat suivant sur la structure de $\mathrm{End}(E)$.

\begin{thm}
$\mathrm{End}(E)$ est
\begin{itemize}
\item soit isomorphe à $\mathbb{Z}$ dans ce cas la courbe est \emph{ordinaire}, 
\item soit isomorphe à un ordre dans un corps quadratique imaginaire dans ce cas la courbe est \emph{ordinaire}, 
\item soit isomorphe à un ordre dans une algèbre de quaternions la courbe est \emph{supersingulière}. 
\end{itemize}
\end{thm}

\begin{proof}
Voir \cite[Corollary III.9.4]{Silv1}, et \cite[Theorem V.3.1]{Silv1}
\end{proof}

\subsection{Courbes définies sur $\mathbb{C}$}
Parler entre autres du polynome modulaire à cette occasion-là.
\subsubsection{Polynôme modulaire}


\section{Courbes elliptiques définies sur un corps fini}

Soit $p$ un nombre premier, on notera $\mathbb{F}_q=\mathbb{F}_{p^e}$ le corps fini à $q$ éléments. Travailler sur un corps fini entraîne le fait que le nombre de points d'une courbe elliptiqe est fini, ainsi nous travaillons avec un groupe abélien fini. Afin d'étudier ce groupe et en particulier d'établir sa cardinalité nous allons introduire l'endomorphisme de Frobenius. Dans la suite de ce document nous considérerons que les courbes elliptiques mentionnées sont définies sur un corps fini.

On a tout d'abord le résultat suivant sur la structure des points d'une courbe elliptique:
\begin{prop}
Le groupe abélien $E(\mathbb{F}_q$) est isomorphe à $\nicefrac{\mathbb{Z}}{n_1 \mathbb{Z}} \times \nicefrac{\mathbb{Z}}{n_2 \mathbb{Z}}$ avec $n_2 \mid n_1$ et $n_2 \mid q-1$
\end{prop}

\begin{proof}
Voir \cite[Theorem 4.1]{Washington2008}
\end{proof}


\subsection{L'endomorphisme de Frobenius}
\begin{defi}
Soit $E$ une courbe définie sur $\mathbb{F}_q$, l'application: 
\begin{equation*}
\begin{alignedat}{1}
\pi :E &\mapsto  E  \\
 (X,Y,Z)  &\mapsto (X^q,Y^q,Z^q)  
\end{alignedat}
\end{equation*}
est un homomorphisme de la courbe et est appelée \emph{endomorphisme de Frobenius}. 
\end{defi}

Comme le groupe de points d'une courbe elliptique  $E(\mathbb{F}_q$) est isomorphe à $\nicefrac{\mathbb{Z}}{n_1 \mathbb{Z}} \times \nicefrac{\mathbb{Z}}{n_2 \mathbb{Z}}$, alors on peut représenter l'action du Frobenius sous forme matricielle et il fait alors sens de parler de la trace $t_{\pi}$ de l'endomorphisme de Frobenius. 

\begin{prop}
Soit $E$ une courbe elliptique définie sur $\mathbb{F}_q$, soit $\pi$ l'endomorphisme de Frobenius. Les conditions suivantes sont équivantes:
\begin{enumerate}
\item $E$ est supersingulière,
\item $E[p^e]=\{O_E\}$ pour tout $e > 0$,
\item la duale $\widehat{\pi}$ de l'endomorphisme de Frobenius est purement inséparable,
\item la trace $t_{\pi}$ de l'endomorphisme de Frobenius est divisible par $p$,
\item l'anneau des endomorphismes $\mathrm{End}(E)$ est isomorphe à un ordre dans une algèbre de quaternions.
\end{enumerate}
si ces conditions ne sont pas vérifiées alors on a les conditions équivalentes suivantes:
\begin{enumerate}
\item $E$ est ordinaire,
\item $E[p^e]=\mathbb{Z}/p^e\mathbb{Z}$ pour tout $e > 0$,
\item la duale $\widehat{\pi}$ de l'endomorphisme de Frobenius est séparable,
\item la trace $t_{\pi}$ de l'endomorphisme de Frobenius est première avec $p$,
\item l'anneau des endomorphismes $\mathrm{End}(E)$ est isomorphe à un ordre dans un corps de nombre quadratique imaginaire.
\end{enumerate}
\end{prop}

\begin{proof}
Voir \cite[Theorem V.3.1]{Silv1}
\end{proof}

L'endomorphisme de Frobenius relatif à $\mathbb{F}_q$ admet pour polynôme caractéristique:
\begin{equation}
\pi^2-t_{\pi}+q=0
\end{equation}
avec $t$ la trace de l'endomorphisme de Frobenius. Cette équation a un rôle important dans le calcul de cardinalité de courbes elliptiques \cite{Schoof85}.

\begin{prop}
Soit $E$ une courbe elliptique définie sur $\mathbb{F}_q$, soit $t_{\pi}$ la trace de l'endomorphisme de Frobenius relatif à $ \mathbb{F}_q$ alors on a:
\begin{equation*}
|E(\mathbb{F}_q)|=q+1-t_{\pi}.
\end{equation*}
\end{prop}

\begin{proof}
Voir \cite[Theorem V.1.1]{Silv1}
\end{proof}

\begin{thm}[Hasse]
Soit $E$ une courbe définie sur $\mathbb{F}_q$, alors 
\begin{equation}
|t| \leqslant 2 \sqrt{q}
\end{equation}
\end{thm}

\begin{proof}
Voir \cite[Theorem V.1.1]{Silv1}
\end{proof}





\subsection{Multiplication complexe}

\subsection{Algorithme de Schoof et ses améliorations}
%Ici vont être présentés les bases de S.E.A., aucun apport personnel n'a été fait dans ce cadre là, mais il est intéressant pour le lecteur de voir les concepts et  le contexte de celui-ci qui seront évoqués plus tard.

L'algorithme de Schoof \cite{Schoof85} consiste à calculer le cardinal d'une courbe elliptique $E$ définie sur $\mathbb{F}_q$ à l'aide de l'équation caractéristique du Frobenius $\pi$:
\begin{equation*}
X^2-t_{\pi}X+q=0
\end{equation*}
Une fois la valeur de la trace du Frobenius $t_{\pi}$ déterminée, on a alors $|E(\mathbb{F}_q)|=q+1-t_{\pi}$. En pratique cette équation est résolue modulo $\ell_i$, avec $\ell_i$ un nombre premier. Cette résolution est répétée pour un ensemble de nombres premiers $L$ tel que: $\prod_{\ell_i \in L}\ell_i>4 \sqrt{q}$, le théorème des restes chinois est alors utilisé pour déterminer $t_{\pi}$ modulo $\prod_{\ell_i \in L}\ell_i$. On utilise ensuite le théorème de Hasse pour déterminer la cardinalité de la courbe.

Le principal problème avec cette approche est que l'on travaille avec la $\ell$-torsion qui lorsque l'on a $\ell \neq p$ est de la forme $E[\ell] \simeq \mathbb{Z}/\ell \mathbb{Z} \times \mathbb{Z}/\ell \mathbb{Z}$. On doit alors travailler modulo le polynôme de $\ell$-division (le polynôme unitaire qui s'annule sur les abscisses des points de $\ell$-torsion) qui est de degré $(\ell^2-1)/2$. L'objectif de l'amélioration d'Elkies est alors de considérer des sous-groupes de la $\ell$-torsion afin de diminuer le coût de l'algorithme.

Des améliorations ont donc été apportées à l'algorithme de Schoof par Atkin et Elkies en analysant plus précisément l'action du Frobenius sur la $\ell$-torsion afin d'exhiber des sous-groupes de la $\ell$-torsion. En  rappelant que $E[\ell] \simeq \mathbb{Z}/\ell \mathbb{Z} \times \mathbb{Z}/\ell \mathbb{Z}$ on peut représenter l'action de $\pi$ sur la $\ell$-torsion sous forme matricielle. Ainsi en analysant les solutions de l'équation caractéristique de $\pi$:
\begin{equation*}
X^2-t_{\pi}X+q = 0 \bmod \ell
\end{equation*} 
on veut voir quand il est possible de déterminer des sous-groupes de la $\ell$-torsion \emph{définis} sur $\mathbb{F}_q$.
On a plusieurs cas possibles selon les propriétés du discriminant $d_{\pi}=t_{\pi}^2-4q$.

\begin{defi}\label{def:dif-Atk-Elk}
Soient $E$ une courbe elliptique ordinaire définie sur $\mathbb{F}_q$ de $j$-invariant $j(E) \neq 0,1728$, $d_{\pi}$ le discriminant du polynôme caractéristique du Frobenius $\pi$ associé à $E$. Soit $\ell$ un nombre premier différent de $p$ la caractéristique de $\mathbb{F}_q$ alors:
\begin{itemize}
\item si $d_{\pi}$ est un résidu quadratique dans $\mathbb{Z}/\ell \mathbb{Z}$ alors $\ell$ est dit nombre premier de Elkies,
\item si $d_{\pi}$ est un non-résidu quadratique dans $\mathbb{Z}/\ell \mathbb{Z}$ alors $\ell$ est dit nombre premier de Atkin.
\end{itemize} 
\end{defi}
	Avec cette distinction il va être possible selon les cas de déterminer des espaces propres pour le Frobenius appliqué à $\ell$-torsion. Avant cela on a besoin d'énoncer la définition suivante:
\begin{defi}
Soit $E$ une courbe elliptique ordinaire définie sur $\mathbb{F}_q$. Soit $C$ un sous-groupe de $E[\ell]$ d'ordre $\ell$. On note $r$ le plus petit entier $\rho$ tel que $\pi^{\rho}(C)=C$.
\end{defi}	
	 
	Dans le cas Elkies on doit faire une distinction selon la nullité du discriminant $d_{\pi}$ modulo $\ell$. 
\begin{itemize}	
	\item Si $d_{\pi}=0 \bmod \ell$ alors il n'y a qu'une seule valeur propre $\lambda$ et l'espace propre est défini sur $\mathbb{F}_{q^r}$ avec $r=1$ si l'espace propre est de dimension $2$ sur $\mathbb{F}_q$ et $r=\ell$ si seulement un espace propre de dimension $1$ est défini sur $\mathbb{F}_q$.
	\item Si $d_{\pi} \neq 0 \bmod \ell$ alors il y a deux valeurs propres $\lambda$, $\mu$ et les espaces propres sont définis sur $\mathbb{F}_q$.
\end{itemize}

	Dans le cas Atkin les valeurs propres ne sont pas définie sur $\mathbb{F}_\ell$ mais sur $\mathbb{F}_{\ell^2}$, les espaces propres sont alors définis sur $\mathbb{F}_{q^r}$ avec $r \mid \ell+1$.
	
	
	On ne peut connaître à priori ce résultat, car il suppose la connaissance de $t_{\pi}$ et donc la cardinalité de la courbe. On doit donc travailler avec un autre objet le $\ell$-ème polynôme modulaire $\Phi_{\ell}(X,Y) \in \mathbb{Z}[X,Y] $ de degré $\ell+1$ et symétrique. 
 
\begin{defi}
Soient $j_0 \in \mathbb{F}_q$ le $j$-invariant d'une courbe elliptique $E_0$ définie sur $\mathbb{F}_q$ de $j$-invariant $j(E) \neq 0,1728$ et  $\Phi_{\ell}(X,Y) \in \mathbb{Z}[X,Y] $ le $\ell$-ème polynôme modulaire. Les $\ell+1$ racines du polynôme $\Phi_{\ell}(X,j_0)$ sont les $j$-invariants de courbes $\ell$-isogénes à $E_0$. 
\end{defi} 
Les $j$ invariants des courbes $\ell$-isogènes à $E_0$, racines du polynôme modulaire évalué en $j_0$, correspondent exactement aux $j$-invariants des  courbes générées par les $\ell$ isogénies $E \to E/C$ avec $C$(noyau de l'isogénie) un des $\ell+1$ sous-groupes cycliques de la $\ell$-torsion. 

On montre alors le lien entre l'existence des espaces propres et les racines du $\ell$-ième polynôme modulaire $\Phi_{\ell}$ par la proposition suivante. 

 
 
% Dés lors avec cette remarque on voit un moyen de déterminer des sous groupes cycliques $C$ de  la $\ell$ torsion. En effet à l'aide des $j$-invariants des courbes $\ell$-isogènes à $E_0$ on peut calculer une représentation des courbes codomaines de ces $\ell$-isogénies. Une description de ces calculs peut être trouvée dans \textcolor{red}{Citer exemple}, ces calculs utilisent notamment les dérivées partielles du polynôme modulaires. Une fois que l'on a déterminé les équations des courbes codomaines des isogénies alors on utilise un algorithme de calcul d'isogénies comme \citep{BMSS08}, \cite{Lercier-Sirvent2008}, \cite{Couveignes00} \textcolor{red}{Citer aussi Elkies of course} afin de déterminer le noyau de l'isogénie.  
 
% Cependant il faut que le noyau de l'isogénie $C$ soit défini sur le corps sur lequel on travaille. On a alors le résultat suivant qui nous permet d'énoncer dans quel corps $C$ est défini en fonction des cas.

%On a un premier résultat qui nous permet de spécifier certains sous ensembles de la $\ell$-torsion.

\begin{prop}\label{pro:def-ss-grp}
Soit $E$ une courbe ordinaire définie sur $\mathbb{F}_q$ de $j$-invariant $j(E) \neq 0, 1728$. Alors:
\begin{enumerate}
\item le polynôme $\Phi_{\ell}(X,j)$ a une racine $j_0 \in \mathbb{F}_{q}^r$ si et seulement si le noyau $C$ de l'isogénie $E \to E/C$ avec $j(E/C)=j_0$ est un espace propre de dimension $1$ pour $\pi^r$ appliqué à $E[\ell]$
\item le polynôme $\Phi_{\ell}(X,j)$ se scinde complètement sur $ \mathbb{F}_{q}^r[X]$ si et seulement si $\pi^r$ agit comme une matrice scalaire sur $E[\ell]$.
\end{enumerate}
\end{prop}

Le théorème suivant de Atkin permet de déterminer plus spécifiquement les cas possibles de factorisation de $\Phi(X,j)$  et aussi d'énoncer si le nombre est de Elkies ou de Atkin selon les cas:

\begin{thm}[Atkin]\label{thm:Atkin}
Soit $E$ une courbe ordinaire définie sur $\mathbb{F}_q$ de $j$-invariant $j(E) \neq 0, 1728$. Soit $\Phi_{\ell}(X,j(E))=f_1f_2\cdots f_s$ la factorisation de $\Phi_{\ell}(X,j(E))$ dans $\mathbb{F}_q[X]$ en éléments irréductibles, alors les degrés possibles de $f_1,f_2, \cdots , f_s$ sont:
\begin{enumerate}
\item $(1,\ell)$ ou $(1,1, \cdots, 1)$. Dans les deux cas $t_{\pi}^2-4q=0 \bmod \ell $, dans le premier cas on pose $r=\ell$ et dans le second $r=1$;
\item $(1,1,r,r, \cdots,r)$. Dans ce cas $t_{\pi}^2-4q$ est un résidu quadratique modulo $\ell$. On a alors $r$ qui divise $\ell-1$ et $\pi$ agit comme une matrice scalaire sur $E[\ell]$;
\item $(r,r,\cdots,r)$ avec $r>1$. Dans ce cas $t_{\pi}^2-4q$ n'est pas un résidu quadratique, $r$ divise $\ell+1$ et la restriction de $\pi$ à $E[\ell]$ admet un polynôme charactéristique irréductible sur $\mathbb{F}_q$. 
\end{enumerate}
\end{thm}
Dans tous les cas on a $r$ qui correspond à l'ordre de la matrice $\pi$ dans $\mathrm{PGL_2}(\mathbb{Z}/\ell \mathbb{Z})$ et la trace du Frobenius $t_{\pi}$ vérifie:
\begin{equation}
\label{eq:sea:tra}
t_{\pi}^2=q(\zeta + \zeta^{-1})^2 \bmod \ell
\end{equation}
avec $\zeta \in \overline{\mathbb{F}_q}$ une racine $r$-ième primitive de l'unité. Ainsi dans le cas Atkin pour déterminer $t_{\pi}$ on est ammené à tester $\varphi(r)/2$ racines primitives $r$-ième de l'unité.

En pratique pour déterminer la nature d'un nombre premier $\ell$ on calcule $g(X)=\mathrm{pgcd}(\Phi(X,\ell),X^q-X)$. Lorsque l'on a $g(X)=1$  alors $\ell$ est un nombre de Atkin, sinon $\ell$ est un nombre de Elkies.

Les nombres premiers de Elkies sont les plus favorables au calcul de $t_{\pi}$ car une fois que l'on a un nombre premier de Elkies alors par la proposition \ref{pro:def-ss-grp} il existe un sous groupe cyclique $C$ de la $\ell$ torsion qui est un espace propre de dimension $1$ pour le Frobenius $\pi$. On résoud alors 
\begin{equation*}
X^2-t_{\pi}X+q = 0 \bmod g_{\ell}
\end{equation*} 
avec $g_{\ell}$ le polynôme qui s'annule sur les abscisses des points de $C$.
Ce groupe $C$ étant plus petit que celui de la $\ell$-torsion, on va diminuer la complexité du calcul à effectuer pour trouver la trace modulo $\ell$. En effet la $\ell$-torsion étant isomorphe à un produit de deux groupes cycliques, une fois une valeur propre trouvée $\lambda$, alors l'autre valeur propre est $\mu=q/\lambda \bmod \ell$ et l'on obtient alors la trace $t_{\pi}=\lambda+\mu \bmod \ell$. 

Par contre pour les nombres premiers $\ell$ de Atkin, comme un sous groupe cylcique de la $\ell$-torsion ne peut être déterminé dans $\mathbb{F}_q$ alors on ne peut déterminer les valeurs exactes de $t_{\pi}$ modulo $\ell$. On doit donc considérer toutes les valeurs possibles données par \eqref{eq:sea:tra}. On répète alors cette opération pour  différents nombres premiers de Atkin, puis on utilise un algorithme à pas de bébé pas de géant pour déterminer la trace du Frobenius. Il existe des améliorations sur l'algorithme à pas de bébé pas de géant proposées par \cite{Ler97a}, ces améloriations utilisent notamment un tri sur les nombres premiers de Atkin en fonction de leur côut. Ce coût est dû au nombre de racines primites $r$-ième de l'unité, qui donnent le nombre de solutions possibles de \eqref{eq:sea:tra}.


On va donc dans la suite de ce document se concentrer sur le cas où $\ell$ est un nombre de Elkies car cela nous permettra de déterminer un sous espace particulier de la $\ell$-torsion et de la $\ell^k$ torsion en général avec $k$ un entier.

Voyons le cas Elkies plus précisément car l'algorithme proposé dans ce document se compare à de la littérature qui se place dans ce contexte particulier.

\subsubsection{Cas Elkies} \label{sub:Elkies}
Lorsque l'on est dans le cas Elkies, on cherche à déterminer un sous-groupe de la $\ell$-torsion qui est aussi espace propre pour le Frobenius, le but étant de déterminer la trace du Frobenius à travers son action sur cet espace propre. 

Ce sous-groupe $C$ est calculé comme étant le noyau de l'isogénie qui relie la courbe $E_0$ (dont on cherche le cardinal) et une des courbes $\ell$-isogènes à $E_0$. Pour trouver l'une des courbes $\ell$-isogènes à $E_0$ il faut calculer les racines du $\ell$-ème polynôme modulaire $\Phi_{\ell}(X,Y)$ évalué en $j_0$ ($j$-invariant de $E_0$), on obtient alors le $j$-invariant des courbes $\ell$-isognèes définies sur $\mathbb{F}_q$. Ces courbes sont définies sur $\mathbb{F}_q$ par leur $j$-invariant à tordue près. Il faut donc se servir du résultat suivant prouvé par Elkies afin de déterminer exactement la courbe isogène à l'aide des formes de Weierstrass.

\begin{prop}
\label{prop:elk:nor}
Soit $E_0$ une courbe elliptique définie sur $\mathbb{F}_q$, un corps de caractéristique différente de $2$ et de $3$, de $j$-invariant différent de $0$ et $1728$, on suppose de plus que $E_0$ admet une courbe $\ell$-isogène $\tilde{E}$. On note l'équation de Weierstrass de $E_0$: $y^2=x^3+a_4x+a_6$. On a alors $\tilde{j}$ le $j$-invariant de $\tilde{E}$ et son équation de Weierstrass
\begin{equation*}
\tilde{E}:y^2=x^3+\tilde{a_4}x+\tilde{a_6}
\end{equation*}
 qui nous est donnée par les équations : 
\begin{equation*}
\tilde{a_4}=-\frac{1}{48}\frac{\tilde{j'}^2}{\tilde{j}(\tilde{j}-1728)} \quad \tilde{a_6}=-\frac{1}{864}\frac{\tilde{j'}^3}{\tilde{j}^2(\tilde{j}-1728)}
\end{equation*}
avec $\tilde{j'} \in \mathbb{F}_q$ donné par:
\begin{equation*}
\tilde{j'}=-\frac{18}{\ell}\frac{a_6}{a_4}\frac{\Phi_{\ell,X}(j,\tilde{j})}{\Phi_{\ell,Y}(j,\tilde{j})}j
\end{equation*}
avec $\Phi_{\ell,X}$(resp. $\Phi_{\ell,Y}$) la dérivée partielle de $\Phi_{\ell}$ en $X$ (resp. $Y$): $\frac{\partial \Phi_{\ell}}{\partial X} $.
\end{prop} 

Maintenant que la courbe isogène est entièrement déterminée, il reste à déterminer le noyau de l'isogénie de celle-ci à l'aide d'algorithmes tels que \cite{BMSS08}  puis \cite{Lercier-Sirvent2008} qui cherchent à résoudre ce problème dans un tel contexte. Une présentation de ces algorithmes est faite \textcolor{red}{ref à mettre plus tard}.


\subsection{Lien entre isogénie et son action sur le module de Tate}

\chapter{Construction efficaces de tours $\ell$-adiques}
La construction d'extension de corps finis est un problème naturel dès lors que l'on travaille sur des corps finis. On peut être ammené à construire des extensions de corps de taille arbitraire pour lesquelles on voudra une construction dite \textit{compatible} de telle sorte que l'on puisse injecter, lorsque cela est possible, des éléments du corps dans les sous-corps pré-existants en ne faisant aucune opération arithmétique.

\begin{defi}[Tour \textit{$\ell$}-adique]
\label{def:tour-ell}
Soit $\ell$ un nombre premier, on appelle tour d'extensions $\ell$-adiques du corps fini $\mathbb{F}_q$ la suite d'extensions: $\mathbb{F}_q, \mathsf{F}_{0}, \mathsf{F}_{1}, \mathsf{F}_{2}, \cdots$ pour lesquels:
\begin{itemize}
\item $\mathsf{F}_{0}$ est une extension de $\mathbb{F}_q$ de degré $d_0$ qui correspond à l'ordre de la matrice du Frobenius restreint à la $\ell$-torsion de la courbe elliptique étudiée: $\pi_{\ell}$, on a donc $d_0 \mid \ell-1$. De plus $r \mid d_0$ avec $r$ qui représente l'ordre multiplicatif de $q$ dans $\mathbb{Z}/\ell \mathbb{Z}$,
\item $\mathsf{F}_{i}$ pour $i \geqslant 1$ est une extension de $\mathsf{F}_{i-1}$ de degré $\ell$.
\end{itemize}
\end{defi}

\begin{rem}
Les constructions de tour d'extensions $\ell$-adiques sont donc spécifiées par l'ordre de la matrice du Frobenius restreint à la $\ell$-torsion de la courbe elliptique étudiée. Cette caractéristique est juste prise en compte pour la détermination de $d_0$ et n'influencera pas autrement la construction de la tour ni les opérations effectuées sur celle-ci. Ainsi une même construction de tour d'extension $\ell$-adique pourra servir pour l'étude de deux courbes elliptiques différentes dès lors que l'ordre de la matrice du Frobenius restreint à la $\ell$-torsion de la courbe elliptique étudiée est la même.
\end{rem}

Les travaux de \cite{DeFeo-Shost'12} sur les tours $p$-adiques ont ouvert la voie à d'autres travaux sur les tours $2$-adiques \cite{Doliskani-Schost15} et les tours $\ell$-adiques \cite{DeFeo-Doliskani-Schost13}. Dans ces travaux l'idée pour obtenir des constructions de tours de corps finis compatibles est le passage de représentation \textit{univariée} à \textit{bivariée}. Ici représentation univariée signifie que l'on peut représenter tout élément de $\mathsf{F}_i$ comme un polynôme de $\mathbb{F}_q[x_i]$ avec $x_i$ un élément de primitif de $\mathsf{F}_i$, de même une représentation bivariée signifie que l'on peut représenter tout élément de $\mathsf{F}_i$ comme un polynôme de $\mathbb{F}_q[x_i, x_{i-1}]$ avec $x_i$(resp. $x_{i-1}$) élément primitif de $\mathsf{F}_i$ (resp. $\mathsf{F}_{i-1}$). Ces idées ont permis d'obtenir des résultats satisfaisants en terme de complexité comparé aux résultats obtenus en utilisant de l'algèbre linéaire dans les constructions préconisées dans Magma \cite{BosmaCS97}. Ainsi certains algorithmes tels que le \textit{relèvement} ou la \textit{descente} d'éléments dans les corps de la tour $\ell$-adique (et $2$-adique) ont des complexités optimales et correspondent juste à une réécriture des éléments. Le relèvement correspond au fait de prendre un élément de $\mathsf{F}_{i-1}$ et de l'écrire comme un élément de $\mathsf{F}_i$, la descente correspond à l'opération inverse. Il y a aussi des opérations comme le Frobenius, crucial pour l'algorithme \textcolor{red}{ref à mettre plus tard}, ou le calcul de racine carrée qui ont des coûts satisfaisants. Tout cela va être détaillé dans ce qui suit. Les travaux de  \cite{DeFeo-Shost'12} ne seront pas étudiés ici, ces travaux sont en effet complémentaires de ceux étudiés et utilisés ici \cite{Doliskani-Schost15}, \cite{DeFeo-Doliskani-Schost13}.

Une façon naturelle de  construire une extension de corps fini $\mathbb{F}_q$ est de trouver un polynôme $P$ irréductible défini sur $\mathbb{F}_q$ et de degré égal à celui de l'extension désirée et de quotienter ensuite $\mathbb{F}_q[X]$ par celui-ci.
Ainsi les éléments des tours d'extension seront toujours représentés comme des polynômes à coefficients dans $\mathbb{F}_q$, la taille des éléments de $\mathsf{F}_{k}$ sera donc $O(d_0\ell^k)$ éléments de $\mathbb{F}_q$. 

Les complexités sont calculées en nombre d'opérations ($+, \times,\div$) dans $\mathbb{F}_q$, indépendamment de la construction de $\mathbb{F}_q$. 

On notera par $\mathsf{M}: \mathbb{N} \rightarrow \mathbb{N}$ l'application telle que la multiplication d'un polynôme de degré $n$ à coefficients dans $\mathbb{F}_q$ coûte $\mathsf{M}(n)$ opérations dans $\mathbb{F}_q$ et telle que $\mathsf{M}$ est super-linéaire, en utilisant les résultats de \cite{Cantor-Kaltofen91} on a $\mathsf{M}(n)=O(n\log(n) \log \log(n))$. 

L'idée de base de \cite{Doliskani-Schost15} est de permettre un passage efficace d'une représentation bivariée à une représentation univariée afin de rajouter à la volée des extensions de la tour compatibles avec ce qui a été fait auparavant.

\section{Construction d'une tour d'extensions $\ell$-adiques}
L'objectif est de calculer une tour d'extensions $\ell$-adiques du corps fini $\mathbb{F}_q$, avec $q \wedge \ell =1$, de taille $\mathbb{F}_{q^{d_0n}}$ avec $n=\ell^k$, $k \geqslant 1$ et $d_0 \mid \ell-1$. 

\begin{thm}
Soit $\ell$ un nombre premier, soit $\mathbb{F}_q$ un corps fini, alors une tour d'extensions $\ell$-adiques du corps $\mathbb{F}_q$: $\mathbb{F}_q, \mathsf{F}_0, \mathsf{F}_1, \mathsf{F}_2, \cdots$ est calculée en $O(d_0\mathsf{M}(d_0)\log(d_0)\log(d_0q))+O(\mathsf{M}(\ell)\log(d_0)+\mathsf{M}(d_0)\log(\ell)\log(d_0)+\mathsf{M}(d_0)\log(q))+O(d_0^2)$ opérations en moyenne sur $\mathbb{F}_q$.
\end{thm}
 
 \begin{proof}
  %Pour $q \neq 1 \bmod \ell$ on se ramène au cas $q=1\bmod \ell$ en construisant une extension $\mathsf{F}_{0}$ de $\mathbb{F}_q$ de degré $d_0 \mid r$ avec $r$ qui représente l'ordre multiplicatif de $q$ dans $\mathbb{Z}/\ell \mathbb{Z}$,
  Deux cas se présentent selon que la valeur de $d_0$:
  \begin{itemize}
  

  \item  Pour $d_0 \neq 1$ on construit tout d'abord $\mathsf{F}_0$ l'extension de $\mathbb{F}_q$ de degré $d_0$ qui divise $\ell-1$ et est donc premier avec $\ell$. Cette construction de $\mathsf{F}_0$ est faite en même temps que la détermination d'un non-résidu $\ell$-adique. 

%Tout d'abord on détermine la nature de $\mathsf{F}_0$, pour cela on calcule le $\ell$-ème polynôme cyclotomique $\Phi_{\ell} \in \mathbb{Z}[X_0]$ et on le factorise sur $\mathbb{F}_q[X_0]$ par \cite[Th 9]{Shoup93} cela a un coût de $O_e(\mathsf{M}(\ell)\log(\ell q))$ opérations sur $\mathbb{F}_q$. Sur $\mathbb{F}_q[X_0]$, $\Phi_{\ell}$ se scinde en facteurs irréductibles de même degré $r$. Si $r=1$ alors on a $\mathbb{F}_q \equiv \mathsf{F}_0$ sinon on doit construire $\mathsf{F}_0$.
On calcule un polynôme irréductible de degré $d_0$ défini sur $\mathbb{F}_q$, pour cela on utilise par exemple l'algorithme probabiliste de Ben-Or qui calcule un tel polynôme avec une complexité moyenne de $O(d_0\mathsf{M}(d_0)\log(d_0)\log(d_0q))$ opérations sur $\mathbb{F}_q$ d'après \cite[Theorem 14.42]{vzGJG03}.
 Soit $R_0$ un tel polynôme, alors par construction il existe un non-résidu $\ell$-adique dans $\mathbb{F}_q[X_0]/ \langle R_0 \rangle $. On trouve après avoir testé $O(1)$ éléments tirés au hasard par \cite[Lemma 15]{Shoup93}  un tel non-résidu $\ell$-adique, chaque essai a un coût moyen de $O(\mathsf{M}(\ell)\log(d_0)+\mathsf{M}(d_0)\log(\ell)\log(d_0)+\mathsf{M}(d_0)\log(q))$ opérations sur $\mathbb{F}_q$. Une fois un tel non-résidu $\ell$-adique $y_0$ trouvé on calcule son polynôme minimal $P_0$, ce calcul coûte $O(d_0^2)$ opérations sur $\mathbb{F}_q$ d'après \cite[Th. 4]{Shoup93}. On construit donc $\mathsf{F}_0=\mathbb{F}_q[X_0]/\langle P_0(X_0) \rangle$ et le non-résidu $\ell$-adique sera alors l'image de $X_0$ dans $\mathsf{F}_0$. On construit dès lors toute extension $\mathsf{F}_{i}$ de $\mathbb{F}_{q}$ pour $i \geqslant 1$ à l'aide du polynôme irréductible $P_0(X^{\ell^{i}})$ défini dans $\mathbb{F}_q[X]$. 
 
  \item Pour $d_0 = 1$ on a $\mathsf{F}_0 \equiv \mathbb{F}_{q}$ ainsi on cherche un non-résidu $\ell$-adique de la même manière que la méthode préconisée dans le cas $d_0 \neq 1$. Une fois un tel non-résidu $\ell$-adique $\alpha$ trouvé on définit $\mathsf{F}_i$ pour $i \geqslant 1$ à l'aide du polynôme irréductible $X^{\ell^{i}}-\alpha$ défini dans $\mathbb{F}_q[X]$.
 
  \end{itemize}
 \end{proof}
 
 \begin{rem}
 Sachant que $d_0 \mid \ell-1$ ce coût peut être borné à l'aide de $\ell$ de la façon suivante: $O(\mathsf{M}(\ell)(\log(\ell)^2)+\log(\ell)+\log(q)+\ell \log(\ell)\log(\ell q))+O(\ell^2)$ opérations en moyenne sur $\mathbb{F}_q$.
 \end{rem}
 
 %$\mathsf{F}_0$ étant une extension de degré premier à $\ell$ de $\mathbb{F}_q$ %alors lorsque l'on a une complexité exprimée en termes d'opérations sur $\mathsf{F}_0$ 
%%on pourra appliquer les résultats obtenus sur les différents algorithmes étudiés (relèvement, descente, Frobenius) lorsque $q=1 \bmod \ell$ en 
%on rajoute un facteur multiplicatif $O(\mathsf{M}(r))\log(r)$ pour prendre en compte le coût des opérations algorithmiques dans $\mathsf{F}_0$. En pratique pour ne pas surcharger les calculs de complexité on remplacera ce facteur multiplicatif $O(\mathsf{M}(r))\log(r)$ par $O(\mathsf{M}(\ell))\log(\ell)$ }
%\paragraph{}{ Pour $q=1 \bmod \ell$ on pose $F_0=\mathbb{F}_q$. Tout non résidu $\ell$-adique $x_0$ de $\mathbb{F}_q$ permet de construire le polynôme irréductible $X^n-x_0$, duquel on déduit alors une construction de $\mathsf{F}_{n}$. Le calcul de ce non résidu $\ell$-adique se fait après avoir testé $O(1)$ éléments tirés au hasard chaque test s'effectuant en $O_e(\log(q))$ opérations sur $\mathbb{F}_q$ par \cite[Lemma 15]{Shoup93}.} 
%\subsubsection{$\ell=2$}
%Pour $\ell=2$ comme vu dans \cite[Theorem VI.9.1]{lang2002algebra} et mis en pratique dans \cite{Shoup93} pour calculer une extension quadratique d'un corps fini $\mathbb{F}_q$ on a deux cas à considérer:
%\begin{itemize}
%\item[$q=1 \bmod 4$] alors tout résidu non quadratique $\alpha$ de $\mathbb{F}_q$ permet de construire le polynôme irréductible $X^n-\alpha$ duquel on déduit alors une construction de $\mathsf{F}_{n}$,
%\item[$q=3 \bmod 4$] on se ramène au cas $q=1\bmod 4$ en construisant une extension quadratique $\mathsf{F}_{0}$ de $\mathbb{F}_q$. On construit celle-ci à l'aide du polynôme irréductible $X^2+1$. Par la même discussion que sur le cas $\ell \neq 2$ et $q \neq 1 \bmod \ell$ on pourra appliquer les résultats obtenus sur les différents algorithmes étudiés (relèvement, descente, Frobenius) lorsque $q=1 \bmod 4$ en rajoutant un facteur multiplicatif négligeable pour prendre en compte le coût des opérations algorithmiques dans $\mathsf{F}_0$.
%\end{itemize} 
%
%Le coût de calcul d'un non résidu quadratique est négligé car un tel résidu peut être trouvé après le test de $O(1)$ éléments choisis au hasard, chaque test ayant un coût de $O(\log(q))$ opérations sur $\mathbb{F}_q$.
%
%De plus il sera considéré pour le corps fini  $\mathbb{F}_q$ que $q=1 \bmod 4$ car le calcul d'une extension quadratique $\mathbb{F}_{q'}$ lorsque $q=3 \bmod 4$ ne rajoute que un facteur $O(1)$ pour le nombre d'opérations sur $\mathbb{F}_q$, cela se justifie par la discussion sur les coûts d'opérations $+,\times, \div$ sur des polynômes de degré $n$ sur $\mathbb{F}_q$.

%A partir de maintenant on travaillera sur les corps $\mathsf{F}_k$ de la tour d'extension $\ell$-adique considérés comme des extensions de $\mathsf{F}_0$. On fera par la suite une distinction des cas selon que $\mathsf{F}_0 \cong  \mathbb{F}_q$ (id est $r=1$) ou selon que $\mathsf{F}_0 \ncong  \mathbb{F}_q$ (id est $r \neq 1$) afin d'étudier la complexité des opérations effectuées en termes d'opérations élémentaires sur $\mathbb{F}_q$. Les cas $\ell=2$ et $\ell \neq 2$ vont être traités de façon unifiée à partir de maintenant. % se placera dans le cas favorable où l'on a $q=1 \bmod 4$ ou $q = 1 \bmod \ell$, selon que l'on considère spécifiquement une tour $2$-adique ou $\ell$-adique, une approche unifiée de ces cas est privilégiée et sera spécifiée à chaque fois.



\section{Représentation des éléments de la tour d'extension $\ell$-adique}%titre a retravailler
%On rappelle que la tour $\ell$-adique est dénotée: $\mathbb{F}_q, \mathsf{F}_0, \mathsf{F}_1, \mathsf{F}_2, \cdots $ avec $\mathsf{F}_0$ une extension de degré $r$ de $\mathbb{F}_q$ et que pour tout $i \geqslant 1$ $\mathsf{F}_i$ est une extension de degré $\ell$ de $\mathsf{F}_{i-1}$. Comme dit  précédemment on travaille $F_0$ et non $\mathbb{F}_q$ afin de permmettre un traitement plus général des cas, une distinction sera faite par la suite selon que $\mathsf{F}_0 \cong \mathbb{F}_q$ ou $\mathsf{F}_0 \ncong \mathbb{F}_q$.
%afin d'alléger la notation, avec $\mathbb{L}_{k}=\mathbb{F}_{q^{2^{k}}}$ pour tout entier $k$.


Les éléments de $\mathsf{F}_k$ peuvent être représentés de deux manières différentes: \textit{univariée} et \textit{bivariée}, de la même manière que dans \cite{DeFeo-Shost'12}. 

Soit $\alpha$ un non-résidu $\ell$-adique de $ \mathsf{F}_0$, à l'aide de celui-ci sont définis les suites de polynômes $T_1,T_2,\cdots, T_k$ en les indéterminées $X_1,X_2, \cdots X_k$ de la façon suivante:
\[
T_1=X_1-\alpha \quad \text{et} \quad T_k=X_k^{\ell}-X_{k-1} \quad \text{avec $k$ entier naturel non nul}
\]  de la même manière la suite de polynômes $P_1,P_2, \cdots P_k$ est définie à l'aide de $\alpha$ de la façon suivante:
\[
P_k=X_k^{\ell^k}-\alpha \quad \text{avec $k$ entier naturel non nul} 
\]

Comme abordé dans \cite{lang2002algebra}, l'égalité entre les idéaux suivants est vérifiée:
\begin{equation}
\label{eq:corres-repre-2}
\langle T_1, T_2, \cdots, T_k \rangle = \langle P_k, X_{k-1}-X_k^{\ell}, ..., X_1-X_{k}^{\ell^{k-1}} \rangle,
\end{equation}
Cet idéal premier est alors appelé $A_k$ et l'on a:
\[
\mathsf{F}_k \cong \mathsf{F}_0[X_1,X_2,\cdots,X_k]/A_k
\]
Soit $k \geqslant 1$  on note $x_k$ l'image de l'indéterminée $X_k$ dans l'anneau résiduel $\mathsf{F}_0[X_1,X_2, ...,X_k]/A_k$, alors par inclusion naturelle de $\mathsf{F}_0[X_1,X_2, ...,X_k]/A_k$ dans $\mathsf{F}_0[X_1,X_2, ...,X_{k+1}]/A_{k+1}$, $x_k$ peut aussi être vu comme un élément de $\mathsf{F}_{j}$ pour $j \geqslant k$.

De plus grâce à l'équation \eqref{eq:corres-repre-2}, représenter un élément de $\mathsf{F}_k$ peut être fait soit comme un polynôme en $x_1, ..., x_k$ de degré au plus $\ell-1$ en chaque variable grâce au côté gauche de l'équation \eqref{eq:corres-repre-2}, soit comme un polynôme en $x_k$ de degré au plus $\ell^k-1$ grâce au côté droit de l'équation.

L'écriture par défaut des éléments de $\mathsf{F}_k$ sera donc la représentation univariée c'est à dire un élément de $\mathsf{F}_k$ sera représenté sous la forme $g(x_k)$ avec $g$ un polynôme de $\mathsf{F}_0[X_k]$ de degré strictement inférieur à $\ell^k$. 

Cependant lors des représentations d'éléments de $\mathsf{F}_k$ il ne va pas être fait des changements de représentation d'un élément sous la forme $g(x_k)$ avec $g$ un polynôme de $\mathsf{F}_0[X_k]$ à un élément sous la forme $h(x_1,x_2,\cdots,x_k)$ avec $h$ un polynôme de $\mathsf{F}_0[X_1,X_2,\cdots,X_k]$ mais seulement à un élément de la forme $i(x_k,x_{k-1})$ avec $i$ un polynôme de $\mathsf{F}_0[X_k,X_{k-1}]$. Cette dernière représentation est suffisante pour permettre d'effectuer la descente d'un élément dans la tour d'extensions $\ell$-adiques.

On représentera alors $\mathsf{F}_k$ pour $k\geqslant1$ des deux façons suivantes:
\begin{equation*}
\mathsf{F}_k \cong \mathsf{F}_0[X_k]/\langle P_k(X_k) \rangle \cong \mathsf{F}_0[X_k,X_{k-1}]/\langle P_{k-1}(X_{k_1}), X_k^{\ell}-X_{k-1}  \rangle
\end{equation*}
  
\begin{defi}
Soit $\mathsf{F}_k$ un élément de la tour d'extensions $\ell$-adiques de $\mathbb{F}_q$.
La $\mathsf{F}_0$ base monovariée de $\mathsf{F}_k$ est:
\begin{equation*}
1,x_k,x_k^{\ell},...,x_k^{\ell^k-1}
\end{equation*}
la $\mathsf{F}_0$ base bivariée de $\mathsf{F}_k$ est:
\begin{equation*}
1,x_{k-1},x_{k-1}^{\ell},...,x_{k-1}^{\ell^{k-1}-1},x_k,x_kx_{k-1},x_kx_{k-1}^2,...,x_kx_{k-1}^{\ell^{k-1}-1}
\end{equation*}
\end{defi}

En pratique le changement de base monovariée à bivariée se fait de la façon suivante à partir d'une expression $G(x_k)$ d'un élément de $\mathsf{F}_k$ avec $G$ un polynôme de degré inférieur à $\ell^k-1$:
\begin{equation*}
G(x_k)=G_0(x_k)+x_kG_1(x_k^\ell)=G_0(x_k)+x_kG_1(x_{k-1})
\end{equation*}
avec $G_0$ et $G_1$ des polynômes de degré inférieur à $\ell^{k-1}-1$. Ce changement de base ne requiert aucun calcul arithmétique, ainsi celui-ci pourra être utilisé sans coût supplémentaire et en particulier un élément pourra être considéré indifféremment dans une base bivariée ou univariée.%a completer

La descente correspond donc au passage d'un élément de $\mathsf{F}_k$ écrit sous la forme $G(x_k)$ en un élément de la forme $G_1(x_{k-1})$ appartenant à $\mathsf{F}_{k-1}$. Le relèvement est l'opération inverse.

\section{Opérations dans la tour d'extension $\ell$-adique}

\subsection*{Inversion d'un élément dans le cas $\ell=2$}


L'inversion d'un élément peut être effectuée dans une base univariée en utilisant l'algorithme d'Euclide étendu. Le coût d'inversion d'un élément de $\mathsf{F}_k$ serait de $O(\mathsf{M}(\ell^kd_0)\log(\ell^kd_0))$ opérations sur $\mathbb{F}_q$ en utilisant les résultats de \cite[ch.11]{vzGJG03}. Une autre technique plus avantageuse est préférée uniquement pour le cas $\ell=2$, soit $G(x_k)$ un élément inversible de $\mathsf{F}_k$ alors en écrivant $G(x_k)=G_0(x_{k-1})+x_kG_1(x_{k-1})$ on obtient:
\begin{align*}
\frac{1}{G(x_k)} &=\frac{1}{G_0(x_{k-1})+x_kG_1(x_{k-1})} \\
 				&= \frac{G_0(x_{k-1})-x_kG_1(x_{k-1})}{G_0(x_{k-1})^2-x_{k-1}G_1(x_{k-1})^2}
\end{align*}
Le coût d'une inversion d'un élément de $\mathsf{F}_k$ est le coût d'une addition, de la multiplication d'éléments de $\mathsf{F}_k$ ainsi que le coût d'une inversion d'éléments dans $\mathsf{F}_{k-1}$, on a donc affaire à un algorithme récursif de coût  $T(k)=T(k-1)+O(M(\ell^kd_0))$; avec la super linéarité de $M$ on obtient un coût de calcul de $O(M(\ell^k)d_0)$ opérations sur $\mathbb{F}_q$. La complexité de l'inversion est donc de $O(M(\ell^k)d_0)$ opérations sur $\mathbb{F}_q$ dans le cas où l'on considère une extension dyadique.

\subsection*{Calcul du Frobenius}

Cette opération est très importante pour déterminer des ensembles spécifiques de points d'une courbe elliptique (voir \textcolor{red}{ref à mettre plus tard}), c'est pourquoi on s'attache ici à montrer que l'on peut effectuer cette opération à un coût raisonnable comparé au cas $\ell=2$ \cite{Doliskani-Schost15}. Le résultat ici est une généralisation de \cite{Doliskani-Schost15}.

\begin{thm} \label{thm:frob-ell}
Soit $\mathbb{F}_q, \mathsf{F}_0, \mathsf{F}_1,  \cdots \mathsf{F}_n$ une tour d'extensions $\ell$-adiques
% définie telle que $[F_{i+1}:F_i]=\ell$ pour $i \neq 0$ et $[F_1:F_0]=d_1$ avec $d_1$ égal à l'odre multiplicatif de $q=|F_0|$  dans $\mathbb{Z}/\ell \mathbb{Z}$ (voir \textcolor{red}{(réf à mettre plus tard)} pour plus de détail). 
Soit $a$ un élément de $F_i$ pour tout entier $j$ le calcul de la puissance $|\mathsf{F}_j|$ de $a$ coûte
 $O(\ell^{i}M(d_0))$ opérations sur $\mathbb{F}_q$ après un pré-calcul de $O( M(d_0)\log(|\mathsf{F}_0|))$ opérations sur $\mathbb{F}_q$
auquel il faut ajouter un calcul booléen de $O(\log(\ell^j)\log(\ell^i|\mathsf{F}_0|))$.
\end{thm} 

\begin{proof}
Sans perte de généralité on peut supposer que l'on a $j<i$, le résultat étant sinon $a$ lui-même. Notons $s= |\mathsf{F}_j|$ et $d=[\mathsf{F}_i:\mathsf{F}_0]=\ell^{i}$. Soit $x_i$ l'image de $x$ dans $F_i=\mathsf{F}_0[x]/P_i(x)$, on a en particulier $x_i^d=x_0$.

La première étape est de calculer $y=x_i^s$. En écrivant $s=ud+v$ avec $0 \leqslant v < d$ on a alors $y=x_0^{u \bmod |F_0|-1}x_i^v$. 
Une méthode rapide est préconisée pour le calcul de $u \bmod |\mathsf{F}_0|-1$ et $v$, dans un premier temps il faut calculer $\rho=s \bmod \ell^i(|\mathsf{F}_0|-1)$ à l'aide de l'exponentiation rapide puis $u \bmod |\mathsf{F}_0|-1$ et $v$ sont obtenus comme le quotient et le reste de la division euclidienne   de $\rho$ par $\ell^i$. Le coût booléen d'une telle opération est de $O(\log(\ell^j)\log(\ell^{i}|\mathsf{F}_0|))$. L'opération majeure étant l'exponentiation avec un exposant de taille $O(\ell^{j}\log(|\mathsf{F}_0|))$ modulo un entier de taille $O(\log(\ell^{i}|\mathsf{F}_0|))$, le calcul de $x_0^{u \bmod |\mathsf{F}_0|-1}$ se fait en utilisant $O( M(d_0) d_0\log(q))$ opérations sur $\mathbb{F}_q$. On conserve ce résultat sous la forme d'un monôme dans $F_0[x_i]$. 

Dans la tour d'extensions $\ell$-adiques les éléments de la tour peuvent être représentés sous forme $G(x_k)$ avec $G$ un polynôme de degré $d$ à coefficients dans $\mathsf{F}_0$, or un élément $G(x_k)$ peut aussi être représenté sous forme $H(x_k)$ avec $H$ un polynôme de degré $d_0d$ à coefficients dans $\mathbb{F}_q$. \'A travers le calcul du Frobenius on va expliciter ces changements de représentation. On se place dans le cas où $\mathbb{F}_q \ncong \mathsf{F}_0$ avec $a$ représenté sous la forme d'un polynôme en $x_i$ de degré inférieur ou égal à $[\mathsf{F}_i:\mathbb{F}_q]$ : 
\begin{equation*}
a^*_0+a_1^*x_i+ \cdots + a^*_{d_0d-1}x_i^{d_0d-1}
\end{equation*}
avec les $a_i^* \in \mathbb{F}_q$. On réécrit $a$ sous la forme:
\begin{equation*}
a_0+a_1x_i+ \cdots + a_{d-1}x_i^{d-1}
\end{equation*}
avec les $a_w=a_w^* + \sum_{k=1}^{d_1d-1/d}a_{i+dk}^*x_0^k \in \mathsf{F}_0$ pour $w$ appartenant à $[0; d-1]$. Pour obtenir cette réécriture on s'est servi du fait que pour $t$ appartenant à $[1; d_0d-1]$ tel que $t=d u_t+v_t$ avec $0 \leqslant v_t<d$ on a $x_w^t=x_0^{u_t \bmod |\mathsf{F}_0|-1}x_w^{v_t}$ . Ainsi cette opération est juste un réarrangement des coefficients de $a$.

On écrit $a^s$ sous la forme:
\begin{equation*}
a_0 + a_1 y + a_2 y^2 + \cdots + a_{d-1}y^{d-1}
\end{equation*}
On calcule alors $a(y)$ par la méthode de Horner. Les puissances $y^k$ étant des monômes dans $F_0[x_i]$, on calcule chacune des puissances successives à l'aide de la précédente en $O(M(d_0))$ opérations sur $\mathbb{F}_q$. On a alors un coût total de $O(\ell^{i}M(d_0)))$ opérations dans $\mathbb{F}_q$. En réarrangeant les monômes $a_k y^k$ on obtient un polynôme en $(x_0,x_i)$ de degré $(d_0,d)$, on réécrit alors $a^s$ sous la forme $G(x_i)$ avec $G$ un polynôme à coefficients dans $\mathbb{F}_q$ de degré $d_0d$  à l'aide du changement de représentation inverse de celui effectué précédemment. En effet $a^s$ est représenté sous la forme:
\begin{equation*}
b_0 + b_1 x_i + b_2 x_i^2 + \cdots + b_{d-1}x_i^{d-1}
\end{equation*}
avec $b_k$ un élément de $\mathsf{F}_0$ pour tout $k$. En remarquant que
\begin{equation*}
 b_k=b_{k,0} + b_{k,1}x_0 + \cdots + b_{k,d_1-1} x_0^{d_1-1}=b_{k,0} + b_{k,1}x_i^d + b_{k,2} x_i^{2 \times d} + \cdots + b_{k,d_0-1} x_i^{(d_0-1)\times d} 
\end{equation*}
 avec $b_{k,i}$ un élément de $\mathbb{F}_q$ pour tous $k,i$, on représente $a^s$ sous la forme:
\begin{equation*}
b_0^* + b_1^* x_i + b_2 x_i^2 + \cdots + b_{d_0d-1} x_i^{d_0d-1}
\end{equation*}
 en  utilisant la transformation $b_k^*=b_{u,v}$ pour tous $k,u,v$ tels que $k=ud+v$ avec $0 \leqslant v < d$.
\end{proof}

Maintenant que le coût du Frobenius a été établi nous allons voir une autre opération nécessaire pour le calcul d'isogénies dans le cas de tours dyadiques, le calcul de racines carrées.

\subsection*{Calcul d'une racine carrée}
Les résultats présentés sont issus d'idées développées dans \cite{Doliskani-Schost14} et sont adaptés à la construction de tour d'extensions $\ell$-adiques présentée ici où le coût du Frobenius est très faible. Le résultat à retenir est celui pour les extensions dyadiques du fait de son usage pratique même si une généralisation est présentée. 

\begin{prop}
Soit $\mathbb{F}_q, \mathsf{F}_0, \cdots \mathsf{F}_k$ une tour d'extension $\ell$-adique. Soit $\delta$ un carré non nul de $\mathsf{F}_k$, alors une racine carrée $\gamma$ de $\delta$ est calculée en $O(M(\ell^kd_0)\log(\ell^kq))$ opérations sur $\mathbb{F}_q$.
\end{prop}

\begin{proof}
Soit $\delta$ un carré non nul de $\mathsf{F}_k$ ayant pour racine carrée $\gamma$. Soit $\beta$ dans $\mathsf{F}_0$ défini de la manière suivante:
\begin{align}
\label{eq:trace-square-root}
\beta=T_{\mathsf{F}_k/\mathsf{F}_0}(\gamma)=\sum_{i=0}^{\ell^k-1}\gamma^{|\mathsf{F}_0|^i}&=\gamma(1+\gamma^{|\mathsf{F}_0|-1}+\cdots+ \gamma^{|\mathsf{F}_0|^{\ell^k-1}-1} ) \\
&=\gamma(1+\delta^{(|\mathsf{F}_0|-1)/2}+\cdots+ \delta^{(|\mathsf{F}_0|^{\ell^k-1}-1)/2}) \\
&=\gamma \eta
\end{align}
en posant 
\begin{align*}
\eta=1+\delta^{(|\mathsf{F}_0|-1)/2}+\cdots+ \delta^{(|\mathsf{F}_0|^{\ell^k-1}-1)/2}.
\end{align*}
Maintenant si l'on met au carré l'équation \ref{eq:trace-square-root} on obtient alors l'équation suivante dans $\mathsf{F}_0$: 
\begin{equation*}
\beta^2=\delta \eta^2. 
\end{equation*}
Dés lors si $\eta$ est connu, $\beta$ peut être déduit depuis cette équation et $\gamma$ calculé car on a alors
\begin{equation*}
 \gamma=\beta \eta^{-1}.
\end{equation*}
Sans perte de généralité on peut supposer que l'on a $\eta \neq 0$, si ce n'est pas le cas alors on peut remplacer $\delta$ par $\delta c^2$ avec $c$ choisi aléatoirement parmi les inversibles de $\mathsf{F}_k$.
$O(1)$ essais sont nécessaires en moyenne pour obtenir $T_{\mathsf{F}_k/\mathsf{F}_0}(\gamma c) \neq 0$. En effet il y a $|\mathsf{F}_0|^{\ell^k}/|\mathsf{F}_0|$ valeurs de $c$ pour lesquelles on a $T_{\mathsf{F}_k/\mathsf{F}_0}(\gamma c) = 0$ ainsi la probabilité d'avoir $T_{\mathsf{F}_k/\mathsf{F}_0}(\gamma c) \neq 0$ est de $1-(|\mathsf{F}_0|^{\ell^k}/|\mathsf{F}_0|)/(|\mathsf{F}_0|^{\ell^k})=1-1/|\mathsf{F}_0|>1/2$.

Le coût de calcul de $\beta$ est de $O(M(d_0)\log(q)+C(d_0)\log(d_0))$ opérations en moyenne sur $\mathbb{F}_q$ avec $C(n)=O(n^{1.67})$ d'après \cite{doliskani_Schost_2014_root}. Ainsi seul le coût du calcul de $\eta$ est crucial pour obtenir une complexité satisfaisante.

Soit $\lambda$ un élément de $\mathsf{F}_k$ défini par $\lambda = \delta^{(|\mathsf{F}_0|-1)/2} $ on a alors la relation suivante:
\begin{equation*}
\eta = 1 + \lambda + \lambda^{1+|\mathsf{F}_0|} + \lambda^{1+|\mathsf{F}_0|+|\mathsf{F}_0|^{2}} + \cdots + \lambda^{1+|\mathsf{F}_0|+|\mathsf{F}_0|^{2}+\cdots+|\mathsf{F}_0|^{\ell^k-2}} 
\end{equation*}
Pour $m \geqslant 0$ on définit:
\begin{equation}
\zeta_m=\lambda^{|\mathsf{F}_0|+|\mathsf{F}_0|^2+\cdots+|\mathsf{F}_0|^{m}} 
\end{equation}
que l'on peut construire par récurrence:
\begin{equation*}
\zeta_1=\gamma^{|\mathsf{F}_0|} \quad \text{et} \quad
\zeta_m=
\begin{cases} 
\zeta_{m/2}  \zeta_{m/2}\zeta_{m/2}^{|\mathsf{F}_0|^{m/2}} \quad \text{si m est pair }\\
\zeta_{1}  \zeta_{m-1}^{|\mathsf{F}_0|} \quad \text{si m est impair}
\end{cases}
\end{equation*}

On définit aussi
\begin{equation*}
\varepsilon_m=\lambda^{|\mathsf{F}_0|} + \lambda^{|\mathsf{F}_0|+|\mathsf{F}_0|^{2}} + \cdots + \lambda^{|\mathsf{F}_0|+|\mathsf{F}_0|^{2}+\cdots+|\mathsf{F}_0|^{m}}
\end{equation*} 
on a alors une relation de récurrence pour le calcul de $\varepsilon$:

\begin{equation}
\label{eq:varepsilon}
\varepsilon_1=\lambda^{|\mathsf{F}_0|} \quad \text{et} \quad
\varepsilon_m=
\begin{cases} 
\varepsilon_{m/2} + \zeta_{m/2}\varepsilon_{m/2}^{|\mathsf{F}_0|^{m/2}} \text{si m est pair }\\
\varepsilon_{m-1} + \zeta_{m} \text{si m est impair}
\end{cases}
\end{equation}

Ainsi on obtient $\eta=1+\lambda+\lambda \varepsilon_{\ell^k-2}$. 

 
Le calcul de $\lambda$ a un coût de $O(M(\ell^kd_0)\log(q))$ opérations sur $\mathbb{F}_q$. Le calcul de $\varepsilon_1$ et $\zeta_1$ se fait quant à lui à l'aide de $O(1)$ fois le Frobenius. Calculons alors par récurrence le coût total, en supposant que le calcul de $\varepsilon_m$ et $\zeta_m$ ait déjà été effectué. En utilisant les équations \ref{eq:varepsilon} $\varepsilon_{2m}$ et $\zeta_{2m}$ ou $\varepsilon_{2m+1}$ et $\zeta_{2m+1}$ peuvent être calculés en utilisant $O(1)$ Frobenius et $O(1)$ multiplications sur $\mathsf{F}_{k}$. Ainsi $\varepsilon_n$ et $\eta=1+\lambda+\lambda\varepsilon_{n-2}$ sont calculés en $O(M(\ell^kd_0)\log(\ell^k)+M(\ell^kd_0)\log(q))=O(M(\ell^kd_0)\log(\ell^kq))$ opérations sur $\mathbb{F}_q$.
Le coût de calcul de $\gamma$ et $\beta$ étant négligeables par rapport à celui de $\eta$, on a alors un coût total de $O(M(\ell^kd_0)\log(\ell^kq))$ opérations sur $\mathbb{F}_q$.

\end{proof}



Il est à noter que en pratique pour le calcul de racine carrée de $\delta$ on peut parfois être amené à considérer un élément de $\mathsf{F}_k$ qui n'est pas un carré. Cela est testé en pratique sur $\beta$ qui est un résidu quadratique si et seulement si $\delta$ l'est. Une astuce consiste alors à multiplier $\delta$ par l'élément générateur $x_{k}$ du corps $\mathsf{F}_k$ afin  de multiplier cet élément par un résidu non quadratique, on injecte alors $\delta x_k$ dans $\mathsf{F}_{k+1}$. On applique l'algorithme vu précédemment, le résultat obtenu est alors divisé par $x_{k+1}$ pour obtenir la racine carrée de $\delta$ souhaitée.

%\begin{prop}[Doliskani-Schost'15]
%Soit $q=1 \bmod 4$, étant donné un résidu non quadratique $\alpha$ de $\mathbb{F}_q$, alors pour $k\geqslant 0$ et $n=2^k$, les temps de calculs pour les opérations dans $\mathbb{F}_q$ énoncés dans le tableau \ref{tab:complexite-degre2} sont vérifiés.
%\end{prop}

Les coûts des différentes opérations dans de telles tours d'extensions $\ell$-adiques sont résumés dans le tableau  \ref{tab:complexite-degre2}.
\begin{figure}
\label{tab:complexite-degre2}
\begin{tabular}{|l|r|r|}
  \hline
  \text{Opérations}  & \text{Coûts}  \\
   \hline
  \text{addition/soustraction}  & $O(\ell^kd_0)$ \\
  \text{multiplication}  & $\mathsf{M}(\ell^kd_0)+ O(\ell^kd_0)$  \\
  \text{division} & $O(\mathsf{M}(\ell^kd_0))$ \\
  \text{Frobenius} & $O(\ell^k \mathsf{M}(d_0) + d_0 \mathsf{M}(d_0)\log(q))$  \\
  \text{racine carrée} & $ O(\mathsf{M}(\ell^kd_0)\log(\ell^kq)) (\text{en moyenne}) $ \\
  \hline
\end{tabular}
\caption{Coûts des opérations dans $\mathsf{F}_{k}$ exprimées en nombre d'opérations sur $\mathbb{F}_q$}
\end{figure}
Il est à noter que pour le calcul d'une racine carrée le coût est un coût en moyenne, cela est dû à une partie de l'algorithme qui est de type non déterministe (Las Vegas).

Une implantation de construction de tours $2$-adique et des opérations du Frobenius et du calcul de racine carrée ont été réalisé en SageMath le code est disponible à cette adresse: \url{https://github.com/Hugounenq-Cyril/Two_curves_on_a_volcano/blob/master/Code/extension_corps.sage}.

\section{$\ell \neq 2$ [De Feo-Doliskani-Schost] inutile....}

Le travail présenté ici est issu de \cite{DeFeo-Doliskani-Schost13}. Les différences avec le travail de \cite{Doliskani-Schost15} sont notamment des "push" et "pull" plus compliqués à calculer, ainsi que la discussion faite sur l'existence d'un résidu $\ell$ adique qui ne se résout pas de façon aussi simple que dans \cite{Doliskani-Schost15}. Le calcul du Frobenius n'avait pas été fait dans \cite{DeFeo-Doliskani-Schost13}, cela est fait ici lors d'un travail conjoint avec Luca De Feo, Jérome Plut et Eric Schost, les idées utilisées sont des applications directes de celles de \cite{Doliskani-Schost15}.

Dans cette section la tour $\ell$-adique sera écrite:
\[
\mathbb{F}_q, \mathbb{F}_{q^\ell}, \mathbb{F}_{q^{\ell^2}}, \cdots.
\]
L'objectif ici sera de représenter de façon univariée les éléments du corps $\mathbb{F}_{q^{\ell^i}}$, pour cela on va représenter les éléments de ce corps à l'aide d'éléments de $\mathbb{F}_{q}[X_i]/\langle Q_i \rangle$ pour un polynôme irréductible $Q_i \in \mathbb{F}_q[X_i]$. La principale diffculté par rapport au cas $\ell=2$ sera de construire de tels polynômes, pour cela on sera obligé de construire des extensions de corps d'indice $r$ où des résidus non $\ell$ adiques existent. On construira alors sur ces corps des tours d'extension $\ell$-adique, qui contiendront donc des corps de la taille $r\ell^i$. Il faudra alors utiliser une descente dans les corps pour alors avoir des corps de taille $\ell^i$.

\subsection{Notation des représentations}
Comme dit précédemment les éléments du corps $\mathbb{F}_{q^{\ell^i}}$ peuvent être représentés comme des éléments de $\mathbb{F}_q[X_i]/\langle Q_i \rangle $, avec $Q_i$ un polynôme irréductible. Un élément de $\mathbb{F}_{q^{\ell^i}}$ peut être donc représenté à l'aide de la base:

\[
U_i=(1,x_i,x_i^2,\cdots,x_i^{\ell^i-1})
\]

On peut alors vouloir construire une autre base pour représenter $\mathbb{F}_{q^{\ell^i}}$, ainsi à l'aide d'une représentation de $\mathbb{F}_{q^{\ell^{i-1}}}=\mathbb{F}_q[X_{i-1}]/\langle Q_{i-1} \rangle $, d'un polynôme irréductible $T_{i}$ de $\mathbb{F}_{q^{\ell^{i-1}}}$ de degré $\ell$, on a alors une construction de $\mathbb{F}_{q^{\ell^i}}$: $\mathbb{F}_{q^{\ell^{i}}}\simeq \mathbb{F}_q[X_{i-1},X_{i}]/\langle Q_{i-1}(X_{i-1}), T_i(X_{i-1},X_{i}) \rangle $. Ainsi un élément de $\mathbb{F}_{q^{\ell^{i}}}$ pourra être représenté à l'aide de la base bivariée suivante:

\[
B_i=(1,x_{i-1},x_{i-1}^2,\cdots,x_{i-1}^{\ell^{i-1}-1},x_i^{\ell-1},x_i^{\ell-1}x_{i-1}^{\ell^{i-1}-1})
\] 
Le relèvement correspond à un changement de base de $B_i$ vers $U_i$, la descente correspond à un changement de base de $U_i$ vers $B_i$.

Ces opérations de base servent à faire des plongements dans des corps situés à des niveaux plus bas dans la tour, mais sont aussi un moyen de faire des opérations de base plus rapides à l'aide notamment de l'utilisation de bases univariées comme vu précédemment dans le cas $\ell=2$.

De façon plus générale on notera pour $0 \leqslant j \leqslant i $ $Q_{i,j} \in \mathbb{F}_q(x_j)[X_i]$ le polynôme minimal de $x_i$ sur $\mathbb{F}_{q}(x_j)$, il a pour degré $\ell^{i-j}$. On a en particulier $Q_{i,0}=Q_i$ et $Q_{i,i-1}=T_{i}[X_i,X_{i-1}]$.

\subsection{Construction de tours quasi-cyclotomique}
La première étape consiste à construire une extension de corps $\mathbb{K}_0=\mathbb{F}_q[Y_0]/\langle P_0 \rangle$ telle que la classe résiduelle $y_0$ de $Y_0$ soit un résidu non $\ell$ adique de $\mathbb{K}_0$, on note $r$ le degré de $P_0$.

Par \cite[Th. VI.9.1]{Lang2002algebra} on a pour $i \geqslant 1$ le polynôme $Y_i^{\ell^i}-y_0 \in \mathbb{K}_0[Y_i]$ qui est irréductible, le corps $\mathbb{K}_i=\mathbb{K}_0[Y_i]/\langle Y_i^{\ell^i}-y_0 \rangle$ est ainsi un corps à $q^{r\ell^i}$ éléments. En notant $y_i$ les classes résiduelles de $Y_i$ dans $\mathbb{K}_i=\mathbb{K}_0[Y_i]/\langle Y_i^{\ell^i}-y_0 \rangle$, on a ces représentations de corps qui sont naturellement plongées les unes dans les autres à l'aide de l'isomorphisme $\mathbb{K}_{i+1} \simeq \mathbb{K}_i[Y_{i+1}]/\langle Y_{i+1}^{\ell}-y_i\rangle $, en particulier on a $y_{i+1}^{\ell}=y_i$.


 Pour pouvoir construire un corps de taille $\ell^i$ on utilise le processus de descente suivant qui provient d'un  travail de Shoup:

\begin{prop}[Shoup]
Pour $i \geqslant 0$, soit $x_i$ la trace de $y_i$ sur un sous corps d'indice $r$:
\begin{equation*}
x_i=\sum_{j=0}^{r-1}y_i^{q^{\ell^i}j}
\end{equation*}
On a alors par \cite[Th. 2.1]{Shoup88} $\mathbb{F}_q(x_i)=\mathbb{F}_{q^{\ell^i}}$.
\end{prop}

Montrons donc dans un premier temps comment calculer $\mathbb{K}_0 \simeq \mathbb{F}_{q^r}$.



\subsubsection{Calcul d'une extension contenant un résidu non $\ell$ adique}
Le calcul de $P_0$ se fait à l'aide du $\ell$-ème polynôme cyclotomique $\Phi_{\ell} \in \mathbb{Z}[X_0]$ et de sa factorisation sur $\mathbb{F}_q[X_0]$, par \cite[Th.9]{Shoup93} celle-ci a un coût de $O_e(M(\ell)\log(\ell q))$ opérations sur $\mathbb{F}_q$.

$\Phi_{\ell}$ se scinde sur $\mathbb{F}_q[X_0]$ en facteurs irréductibles de même degré $r$, avec $r$ l'ordre de $q$ dans $(\mathbb{Z}/\ell \mathbb{Z})^{\times}$, il est à noter que $r$ divise $\ell-1$. Soit $R_0$ un des facteurs irréductibles de $\Phi_{\ell}$, alors par construction il existe des résidus non $\ell$ adiques dans $\mathbb{F}_q[X]/\langle R_0 \rangle$. Une fois qu'un tel résidu $y_0$ est trouvé son polynôme minimal $P_0$ sur $\mathbb{F}_q$ de degré $r$ est calculé en $O(r^2)$ opérations sur $\mathbb{F}_q$ d'après \cite[Th.4]{Shoup93}. 
En pratique un tel résidu non quadratique $y_0$ est trouvé aléatoirement après $O(1)$ essais d'après \cite[Lemma 15]{Shoup93}, chaque essai a un coût de $O_e(M(\ell)\log(r)+M(r)\log(\ell)\log(r)+M(r)\log(q))$ opérations sur $\mathbb{F}_q$.
%peut etre affiner les sources

Selon la valeur de $r$ on a différents cas qui se présentent à nous pour le calcul de $Q_{i,j}$. Il y a alors deux cas particuliers qui sont ceux où $\ell \mid q-1$ et $\ell \nmid q-1$ et ensuite le cas général qui a une complexité moins intéressante mais toujours linéaire en la taille de l'extension. Le cas général va d'abord être présenté avant de voir les deux cas particuliers qui partagent une construction commune généralisée par l'idée de Couveignes et Lercier \cite{couveignesLercier2013}.

%\paragraph{$\ell \nmid q+1$}
%Dans ce cas $\Phi_{\ell}$ se scinde en facteurs quadratiques sur $\mathbb{F}_q$ (id est $r=2$). Il est alors nécessaire de prendre $y_0$ tel qu'il soit de norme $1$ sur $\mathbb{F}_q$. Le résultat suivant nous donne alors un moyen de calculer $Q_{i,j}$:
%Apparemment inutile car une methode plus simple est trouvée plus tard...
%\begin{prop}
%Pour $1\geqslant j<i$ $Q_{i,j}$ vérifie:
%\begin{equation*}
%Q_{i,j}(X_i)=Y^{\ell^{i-j}-Y^{-\ell^{i-j}}-x_j \bmod Y^2-X_iY+1
%\end{equation*}
%\end{prop}
%
%\begin{proof}
%Voir \cite{DeFeo-Doliskani-Schost13}
%\end{proof}

\subsubsection{Cas général}
Dans ce cas on ne fait aucune hypothèse sur la décomposition de $\phi_{\ell}$ dans $\mathbb{F}_q[X]$. De plus comme $r=[\mathbb{K}_0:\mathbb{F}_q]$ et qu'il divise $\ell-1$ alors $r$ est premier avec $\ell$. Ainsi $Q_i$ est bien le polynôme minimal de $x_i$ sur $\mathbb{F}_q$, de la même manière $Q_{i,j}$ est le polynôme minimal de $x_i$ sur $\mathbb{K}_j$. Ceci nous permet donc de remplacer le corps de base $\mathbb{F}_q$ par $\mathbb{K}_0$. Le calcul se fera sur la base d'opérations dans $\mathbb{K}_0$, un facteur $O(M(r)\log(r))$, qui correspond au coût d'opérations dans $\mathbb{K}_0$, sera ajouté pour avoir le coût exprimé en nombres d'opérations sur $\mathbb{F}_q$.


Pour $i \geqslant 0$, comme $\mathbb{K}_i=\mathbb{K}_0[Y_i]/\langle Y_i^{\ell^i} - y_0 \rangle$, chacun de ses éléments peut être représenté dans une base $ \{y_i^e | 0 \leqslant e < \ell^i \} $, ainsi l'élément $x_i$ s'écrit dans cette base:
\begin{equation*}
x_i= \sum_{0 \leqslant j \leqslant r-1}y_i^{q^{\ell^i}j \bmod \ell^i}y_0^{q^{\ell^i}j / \ell^i}
\end{equation*}
On peut alors représenter $\mathbb{K}_i$ à l'aide des deux bases univariées $\mathbb{K}_i$: $\{ y_i^e | 0 \leqslant e < \ell^i\}$ et $\{x_i^e | 0 \leqslant e < \ell^i\}$. On va alors montrer comment calculer l'isomorphisme entre les deux bases univariées de $\mathbb{K}_i$: $\{ y_i^e | 0 \leqslant e < \ell^i\}$ et $\{x_i^e | 0 \leqslant e < \ell^i\}$:
\begin{equation*}
\Psi_i: \mathbb{K}_i=\mathbb{K}_0[Y_i]/\langle Y_i^{\ell^i}-y_0 \rangle \to \mathbb{K}_0[X_i]/\langle Q_{i,0} \rangle,
\end{equation*}
 %on pourra alors employer la méthode de descente vue dans \cite{Shoup88} sur la représentation image de l'isomorphisme de corps calculée pour avoir une représentation de $\mathbb{F}_{q^{\ell^i}}$. 
 Lors du calcul de $\Psi_i$, le calcul nécessaire de $Q_{i,0}$ et $Q_{i,i-1}$ sera effectué. On se servira de $\Psi_i$ pour calculer la descente et le relèvement entre la base monomiale en $x_i$ et la base bivariée en $(x_{i-1},x_i)$.
 
 On va factoriser $\Psi_i$ en isomorphismes élémentaires:
 \begin{equation*}
 \Psi_{i,j}:\mathbb{K}_{j}[X_i]/\langle Q_{i,j} \rangle \to \mathbb{K}_{j-1}[X_i]/ \langle Q_{i,j-1} \rangle, \quad j=i, \cdots,1. 
 \end{equation*}
 
On commence donc avec $i=j$, dans ce cas-là on pose $Q_{i,i}=X_i-x_i \in \mathbb{K}_i[X_i]$, de telle sorte que $\mathbb{K}_i=\mathbb{K}_i[X_i] / \langle Q_{i,i} \rangle $.

Considérons maintenant le cas $j \leqslant i$ et supposons que $Q_{i,j}$ est connu. $\Psi_{i,j}$ va être alors factorisé en $\Phi_{i,j}'' \circ \Phi_{i,j}' \circ \Phi_{i,j}$, il est alors nécessaire d'introduire l'isomorphisme :
\begin{equation*}
\varphi_j:\mathbb{K}_j \to \mathbb{K}_{j-1}[Y_j]/\langle Y_j^{\ell}-y_{j-1} \rangle
\end{equation*}
Cet isomorphisme est dans son sens direct une descente de la base monomiale en $y_j$ vers la base bivariée en $(y_j,y_{j-1})$ et son inverse est donc un relèvement, aucun des deux ne nécessite des opérations arithmétiques, ces deux opérations sont exactement les mêmes que celles décrites dans le cas simple où $r=1$ \ref{par:easycase}. L'isomorphisme suivant peut alors être calculé:
\begin{equation*}
\Phi_{i,j}: \mathbb{K}_j[X_i]/\langle Q_{i,j} \rangle \to \mathbb{K}_{j-1}[Y_j,X_i]/\langle Y_j^{\ell}-y_{j-1},Q_{i,j}^* \rangle , 
\end{equation*} 
avec $Q_{i,j}^*$ obtenu en appliquant $\varphi_j$ à tous les coefficients de $Q_{i,j}$. Comme $\Phi_{i,j}$ consiste en une application coefficient par coefficient de $\phi_j$ alors appliquer $\Phi_{i,j}$ ou son inverse ne coûte aucune opération arithmétique.

On change ensuite l'ordre entre $Y_j$ et $X_i$, cela permet de déduire l'existence de $S_{i,j} \in \mathbb{K}_{j-1}[X_j]$ et d'un isomorphisme:

\begin{equation*}
\Phi_{i,j}': \mathbb{K}_{j-1}[Y_j,X_i]/ \langle Y_j^{\ell}-y_{j-1},Q_{i,j}^* \rangle \to \mathbb{K}_{j-1}[X_i,Y_j]/\langle Q_{i,j-1}, Y_j-S_{i,j}\rangle
\end{equation*}
avec $\deg(Q_{i,j}^*,X_i)=\ell^{i-j}$ et $\deg(Q_{i,j-1},X_i)=\ell^{i-j+1}$.

\begin{lem}
A partir de $Q_{i,j}^*$, $Q_{i,j-1}$ et $S_{i,j}$ sont calculés en $O(M(\ell^{i+1})\log(\ell^i))$ oéprations sur $\mathbb{K}_0$. Une fois  $Q_{i,j-1}$ et $S_{i,j}$ calculés on peut appliquer $\Phi_{i,j}'$ ou son inverse en $O(M(\ell^{i+1}))$ opérations sur $\mathbb{K}_0$
\end{lem}

\begin{proof}
Voir \cite{DeFeo-Doliskani-Schost13}.
\end{proof}

Le dernier isomorphisme $\Phi_{i,j}''$ s'écrit trivialement:
\begin{equation*}
\Phi_{i,j}'': \mathbb{K}_{j-1}[X_i,Y_j]/\langle Q_{i,j-1}, Y_j-S_{i,j}\rangle \to \mathbb{K}_{j-1}[X_i]/\langle Q_{i,j-1} \rangle 
\end{equation*}
il "oublie" la variable $Y_j$, il ne nécessite aucune opération arithémtique.

En faisant varier $j$ de $1$ à $i$ on peut alors calculer $Q_{i,i-1}$ jusqu'à $Q_{i,0}$ en $O(i^2M(\ell^{i+1})\log(\ell))$ opérations sur $\mathbb{K}_0$. En composant les isomorphismes $\Psi_{i,j}$, on en déduit que $\Psi_i$ ou son inverse peut être calculé en $O(iM(\ell^{i+1}))$ opérations dans $\mathbb{K}_0$.

Montrons alors comment est calculé un relèvement à partir des éléments sus-mentionnés. Soit $A$ un élément écrit dans la base bivariée $(x_i,x_{i-1})$, autrement dit $A$ est dans $\mathbb{K}_0[X_{i-1},X_i]/\langle Q_{i-1}, T_{i} \rangle$. On applique alors $\Psi_{i-1}$ à ses coefficients en $x_i^0,x_i,\cdots, x_i^{\ell-1}$ pour réécrire $A$ comme un élément de
\begin{equation*}
\mathbb{K}_0[Y_{i-1},X_i]/\langle Y^{\ell^{i-1}}-y_{i-2},T_i \rangle = \mathbb{K}_{i-1}[X_i]/\langle Q_{i,i-1} \rangle.
\end{equation*}
On applique alors $\Psi_{i,i}^{-1}:\mathbb{K}_{i-1}[X_i]/\langle Q_{i,i-1} \rangle \to \mathbb{K}_i[X_i]/\langle Q_{i,i} \rangle$ pour avoir l'image de $A$ dans $\mathbb{K}_i$. Enfin on applique $\Psi_{i}:\mathbb{K}_i[X_i]/\langle Q_{i,i} \rangle \to \mathbb{K}_0[X_i]/ \langle Q_i \rangle $ pour avoir $A$ exprimé dans une base monomiale en $x_i$. Faire le push revient à faire l'inverse de ses opérations.


\subsubsection{\boldmath $\ell \mid q-1$}\label{par:easycase}
Maintenant on étudie le cas où $r=1$ lorsque $\Phi_{\ell}$ se scinde en facteurs linéaires sur $\mathbb{F}_q$. Le polynôme $P_0$ s'écrit donc $Y_0-y_0$ avec $y_0$ un résidu non $\ell$-adique de $\mathbb{F}_q$. Comme le calcul de la factorisation de $\Phi_{\ell}$ n'est pas nécessaire, on obtient alors une complexité de $O_e(\log(q))$ opérations sur $\mathbb{F}_q$.

Ce cas-ci permet de ne pas utiliser de méthode de descente car on a $\mathbb{K}_0 \simeq \mathbb{F}_q$ et par conséquent on obtient pour $i \geqslant 0 $   $\mathbb{K}_i \simeq \mathbb{F}_{q^{\ell^i}}$, et donc $x_i=y_i$. Les polynômes obtenus alors sont: $Q_i=X^{\ell^i}-y_0$ et $T_i=X_i^{\ell}-X_{i-1}$. Le relèvement et la descente ne sont que des opérations arithmétiques. En effet pour $F=\sum_{0 \leqslant j \leqslant \ell^{i+1}}f_jx_{i+1}^j$ le relévement réécrit cet élément dans une base $x_i,x_{i+1}$ en utilisant la relation suivante:
\begin{equation*}
x_{i+1}^j=x_i^{j / \ell}x_{i+1}^{j \bmod \ell} 
\end{equation*}
tandis que la descente réécrit un élément éxprimé dans une base $x_i, x_{i+1}$ en un élément exprimé dans la base $x_{i+1}$ en utilisant la relation suivante:
\begin{equation*}
\quad x_i^ex_{i+1}^f=x_{i+1}^{e\ell + f} 
\end{equation*}
 

\subsubsection{Couveignes and Lercier's ideas to explicitely compute Q and T}
Ici vont être présentés des travaux de Couveignes et Lercier \cite{couveignesLercier2013} permettant de calculer des tours $\ell$ adiques.

Dans un premier temps nous allons voir les idées de Couveignes et Lercier, puis dans un second temps nous allons voir un exemple, celui où $\ell$ est un nombre premier différent de $p$ qui ne divise pas $q-1$, cet exemple a été choisi de par l'intérêt de l'objet qu'il manipule: un cycle d'isogénie. Ce sera donc l'occasion pour le lecteur de se familiariser avec les graphes d'isogénies. Un autre cas où le polynôme modulaire se scinde en facteurs linéaires et quadratiques sur $\mathbb{F}_q$ n'est pas traité ici mais l'est dans \cite{DeFeo-Doliskani-Schost13}.

Présentons donc l'idée directrice avant de voir un exemple. Soient $G,G'$ deux $\mathbb{F}_q$ groupes algébriques intègres de même dimension, $\phi: G' \to G$ un morphisme de groupe surjectif et séparable de degré $\ell$, alors l'ensemble des points $x$ de $G$ de fibré $G'_x$ de cardinal $\ell$ est un ensemble ouvert non vide $U \subset G$. 
L'homomorphisme induit de groupes finis $\phi_{\mid \mathbb{F}_q}: G'(\mathbb{F}_q) \to G(\mathbb{F}_q)$ permet lorsqu'il est non surjectif de définir des extensions algébriques de $\mathbb{F}_q$ à partir des fibrés de points de $G(\mathbb{F}_q)$ ne se trouvant pas dans l'image de $\phi_{\mid \mathbb{F}_q}$. 

Pour construire ces extensions algébriques on applique sur un fibré irréductible issu de points ne se trouvant pas dans l'image de $\phi_{\mid \mathbb{F}_q}$ une projection linéaire cela permet alors de  déterminer un polynôme irréductible de degré divisant $\ell$ (espéré égal à $\ell$). Si l'on peut itérer cette méthode avec un nouvel homomorphisme: $\phi':G'' \to G'$ qui vérifie les même conditions que vu précédemment, alors on peut déterminer des extensions $\ell$-adiques de $\mathbb{F}_q$.

On va donc voir une application de cette méthode appliquée sur un cycle d'isogénies de degré $\ell$.

\paragraph{Towers from elliptic curves}
%Dans cette partie on revoit les constructions de Couveignes et Lercier \cite{couveignesLercier2013} et l'on montre en particulier les passages pertinents pour une construction de tour.

Soit $\ell$ un nombre premier différent de $p$ qui ne divise pas $q-1$, soit $E_0$ une courbe elliptiqe de cardinal sur $\mathbb{F}_q$: $|E_0(\mathbb{F}_q)|=\ell^e a$ avec $e \geqslant 1$ et $a \wedge \ell =1$. Une telle courbe existe d'après le théorème de Hasse seulement si $\ell \leqslant q+2\sqrt{q} +1$.  
Pour mettre en pratique l'idée de Couvegines et Lercier \cite{couveignesLercier2013} expliqué plus haut on travaille alors avec des isogénies $\mathbb{F}_q$-rationnelles séparables de degré $\ell$. Il est donc naturel de s'intéresser à l'action du Frobenius sur la $\ell$ torsion afin de déterminer ces isogénies. On étudie donc le polynôme caractéristique du Frobenius:
%peut etre enoncer cela sous forme de proposition ??
\begin{equation*}
X^2-t_{\pi}X+q=(X-1)(X-q) \bmod \ell
\end{equation*}
qui dans ce cas précis se scinde modulo $\ell$.


En effet par hypothèse sur le cardinal de la courbe on a: $|E|=q+1-t_{\pi}=0 \bmod \ell$, on peut alors montrer que $d_{\pi}=t_{\pi}^2-4q=(q+1)^2-4q=(q-1)^2 \bmod \ell$. De plus le fait que $\ell \nmid q-1$ nous permet d'énoncer que le discrimant $d_{\pi}$ du polynôme charactéristique de $\pi$ est différent de $0$ modulo $\ell$, le Frobenius admet donc deux valeurs propres. Enfin on montre que les deux valeurs propres sont $1$ et $q \bmod \ell$ car on a $t_{\pi}=q+1 \bmod \ell$.

Ainsi à l'aide de ces deux valeurs propres on peut déterminer des sous-groupes cycliques de la $\ell$ torsion. 

Comme on ne peut pour le moment que travailler sur $\mathbb{F}_q$, le but de cette méthode étant de construire une extension $\ell$-adique de $\mathbb{F}_q$, on ne peut utiliser que le sous-groupe cyclique de taille $\ell^e$ associé à la valeur propre $1$. On construit donc à l'aide de ce sous groupe une $\ell$ isogénie qui a pour image $E_1$. 

De manière plus générale  on peut affirmer que la $\ell$ torsion de $E_0$ n'est pas entièrement rationnelle car on a $\ell \nmid q-1$, la $\ell$ torsion ne peut donc seulement être cyclique. Ainsi cet argument et la cardinalité de la courbe permettent d'affirmer que l'on a un sous groupe cyclique d'ordre $\ell^e$ défini sur $\mathbb{F}_q$, on peut donc aussi travailler directement avec des $\ell^i$ isogénies avec $1 \leqslant i \leqslant e$.

Le sous groupe cyclique de la $\ell$ torsion défini comme le noyau de $\pi -q$ génère une $\ell$ isogénie rationnelle, car l'ensemble des points de son noyau est stable sous l'action du Frobenius. Ainsi $E_0$ admet deux courbes $\ell$ isogènes, cet argument peut se répéter à ses courbes $\ell$isogènes car celles-ci ont la même cardinalité. On a donc défini un cycle de $\ell$isogénies. Ainsi à partir de $E_0$ on dénote $E_1$ la courbe codomaine de la $\ell$-isogénie qui a pour noyau le sous groupe cyclique de la $\ell$ torsion égal à $\ker (\pi_{|E_0[\ell]} - \mathrm{Id}_{|E_0[\ell]})$, de manière générale on notera $E_{i+1}$ le codomaine de l'isogénie engendré par $\ker (\pi_{|E_i[\ell]} - \mathrm{Id}_{|E_i[\ell]})$ . Ce cycle a une longueur finie comme l'énonce le lemme suivant issu de \cite{DeFeo-Doliskani-Schost13}:

\begin{lem}
Soient $E_0,E_1, \cdots$ les courbes elliptiques définies comme ci-dessus, alors il existe un $n \in O(\sqrt{q}\log(q))$ tel que $E_n$ est isomorphe à $E_0$.
\end{lem}

\begin{proof}
La preuve se sert du théorème de Minkowski qui nous donne une borne sur le nombre de groupe de classe de $\mathbb{Q}[X]/(X^2-t_{\pi}X+q)$. Les détails techniques de cette preuve ne sont pas le sujet de cette partie.
\end{proof}

Ainsi on travaillera avec les courbes $E_i$ avec $i$ modulo la longueur du cycle: $n$. En pratique pour faire cela il faut prendre en compte l'isomorphisme $E_n \simeq E_0$, cet isomorphisme peut être calculé grâce aux formules de Weierstrass et cela n'ajoute pas de grosses opérations arithmétiques à effectuer.

On va donc se servir de ce cycle pour calculer des extensions de façon incrémentale, ainsi on pourra travailler sur des tours dont on ne connaît pas à priori le degré d'extension. 

Montrons comment construire un polynôme irréductible $f(x) \in \mathbb{F}_q[x]$ de degré $\ell$. Soient  les deux entiers $\lambda_{e+1}, \mu_{e+1}$ tels que 
\begin{align*}
\lambda_{e+1}=1 \bmod \ell^{e} \quad , \quad \mu_{e+1}=q \bmod \ell^e, \\
X^2-tX+q = (X-\lambda_{e+1})(X-\mu_{e+1}) \bmod \ell^{e+1} 
\end{align*}
On note $\lambda_{e+1}=1+\ell^el'$ avec $l' \wedge \ell = 1$. Dans la suite on notera tout simplement $\lambda=\lambda_{e+1}$ et $\mu = \mu_{e+1}$. On pose maintenant:
\begin{equation*}
(\ell,\pi-\lambda)=\mathfrak{l}.
\end{equation*}
C'est un idéal inversible, noyau de l'isogénie $\phi_{i}:E_i \to E_{i+1}$. Notre but est de travailler avec un élément de $\ell$ torsion de $E_{i+1}$ pour lequel on est sûr de ne pas avoir d'antécédent par la $\ell$ isogénie défini dans $\mathbb{F}_q$. Le $\ell$ sous-groupe de Sylow de $E_{i+1}(\mathbb{F}_q)$ est le noyau de $\mathfrak{l}^e=(\ell^e,\pi - 1)$ et il est cyclique, on travaille donc avec $A$ un générateur de $\mathfrak{l}^e$ avec $\ell^e \neq 2$. En écrivant l'isogénie $\phi_i$ comme une fraction rationnelle : 
\begin{align*}
\phi_{i}:E_i \to E_{i+1}, \\
(x,y) \mapsto \left( \frac{f_{i}(x)}{g_{i}(x)} ,y \left( \frac{f_{i}(x)}{g_{i}(x)} \right) ^{'} \right)
\end{align*}
%^' \right)

avec $g_i$ le carré du polynôme de degré $\frac{\ell-1}{2}$  qui s'annule sur l'abscisse des points du noyau de $\phi_{i}$, on  définit alors $ T_{1}(X)=f_{1}(x)-g_{1}(x)x(A)$. Soit $B \in E_i(\overline{\mathbb{F}_q})$ tel que $\phi_i(B)=A$, alors  $B$ est un générateur de $\mathfrak{l}^{e+1}=(\ell^{e+1},\pi-\lambda)$. En particulier on a:
\begin{equation*}
\pi(B)=\lambda B
\end{equation*}
avec l'ordre de $\lambda=1+\ell^el'$ dans $(\mathbb{Z}/\ell^{e+1}\mathbb{Z})^*$ qui est $\ell$. Ainsi l'orbite de Galois de $B$ est de taille $\ell$ et le polynôme $T_{1}(X)$,dont les racines appartiennent au fibré $\phi_i^{-1}(A)$, est irréductible. 

Pour définir des extensions successives on prend alors les pré images par les isogénies $\phi_{i_1},\phi_{i_2}, \cdots$. On définit donc la suite de polynômes suivante pour construire une tour d'extension $\ell$-adique en notant $\eta =x(A)$ l'abscisse d'un générateur de la $\ell^e$-torsion de $E_0$:
\begin{align*}
T_0=f_{-1}(X_1)-\eta g_{-1}(X_1), \\
T_i=f_{-i-1}(X_{i+1})-X_{i+1}g_{-i-1}(X_{i+1})
\end{align*}

On aurait pu définir un polynôme irréductible de degré $\ell^{\delta}$ directement en considérant une isogénie $\psi:E_i \to E_{i+\delta}$ de degré $\ell^{\delta}$ et qui a pour noyau $\mathfrak{d}=(\ell,\pi-\lambda_{e+\delta})^{\delta}=\mathfrak{l}^{\delta}$ avec $\lambda_{e+\delta}, \mu_{e+\delta}$ tels que 
\begin{align*}
\lambda_{e+\delta}=1 \bmod \ell^{e} \quad , \quad \mu_{e+\delta}=q \bmod \ell^e, \\
X^2-tX+q = (X-\lambda_{e+\delta})(X-\mu_{e+\delta}) \bmod \ell^{e+\delta} .
\end{align*}

\paragraph{Existence de telles courbes}
Il est naturel de se demander sous quelles conditions on peut trouver une courbe elliptique $E$ définie sur $\mathbb{F}_q$ de cardinal multiple de $\ell$ avec $\ell \wedge q =1$ et $\ell \nmid q-1$. Par le théroème de Hasse si l'on a $\ell \leqslant 2\sqrt{q}$ alors il existe au moins deux entiers multiples de $\ell$ dans l'intervalle $[q+1-2\sqrt{q}, q+1+2\sqrt{q} ] $, on a alors au moins un des deux entiers qui n'est pas congru à $1$ modulo $q$. Il existe donc au moins une courbe de cardinal multiple de $\ell$. L'objectif est donc d'expliciter une borne inférieure sur ce nombre de courbes. Pour cela on utilise les résultats de Lenstra \cite{lenstra1987} qui ont été étendus à notre cas par Howe \cite{howe1993}.

\begin{cor}[Howe]
\label{cor:Howe:densite}
Soit $W(\mathbb{F}_q)$ l'ensemble des courbes elliptiques sous forme de Weierstrass définies sur $\mathbb{F}_q$. Soit $\mu_w$ la mesure uniforme sur cet ensemble et $\ell$  tel que $\ell \nmid q-1$ alors la densité $r(\ell,q)$ de courbes elliptiques sous forme de Weierstrass ayant un point $\mathbb{F}_q$-rationnel d'ordre $\ell$ vérifie:
\begin{equation*}
|r(\ell,q)-\frac{1}{\ell-1}| \leqslant \frac{4\ell(\ell+1)}{(\ell-1)\sqrt{q}}.
\end{equation*}
\end{cor}
Ainsi pour limiter le terme d'erreur pour l'évaluation de $r(\ell,q)$ on se place dans le cas où l'on a $4\ell \leqslant q^{\frac{1}{4}}$, on aura alors l'erreur: $\frac{4\ell(\ell+1)}{(\ell-1)\sqrt{q}} \leqslant \frac{1}{2 \ell} $. Dans ce cas-là on pourra donc considérer qu'il faut répéter $\ell$ fois le choix d'une courbe elliptique sous forme de Weierstrass avant de trouver une courbe de cardinal divisible par $\ell$.

On peut alors énoncer le résultat suivant issu de \cite{DeFeo-Doliskani-Schost13} qui donne le temps de calcul de construction d'une tour $\ell$-adique:

\begin{thm}
Pour $\ell$ premier avec $\ell \leqslant q^{1/4}$, $\ell \wedge q = 1$ et $\ell \nmid q-1$. L'initialisation de la tour requiert $O_e(\ell \log^5(q)+\ell^3)$ opérations binaires; la construction du $i$-ème étage de la tour requiert $O_e(\ell^2+M(\ell)\log(\ell q)+M(\ell^i)\log(\ell^i))$ opérations sur $\mathbb{F}_q$
\end{thm} 

\begin{proof}
Le coût de calcul de la cardinalité d'une courbe elliptique est de $O(\log q)^{5+\epsilon(q)}$ opérations élémentaires en utilisant l'algorithme de Schoof. On a cette opérations à répéter jusqu'à $\ell$ fois pour espérer trouver une courbe de cardinal multiple à $\ell$ d'après le corollaire \ref{cor:Howe:densite}. Le coût total de calcul d'une courbe de cardinalité multiple de $\ell$ est donc de  $O(\ell\log q^{5+\epsilon(q)})$. Pour calculer les $j$-invariants du graphe cyclique de $\ell$-isogénies on a besoin de calculer le $\ell$-ème polynôme modulaire $\Phi_{\ell}$ modulo $p$, il est d'abord calculé sur $\mathbb{Z}$ avec un coût de $\tilde{O}(\ell^3)$ opérations binaires d'après \cite{enge2008} puis réduit modulo $p$. On doit aussi calculer un point d'ordre $\ell^e$ pour cela on choisit au hasard un point de la courbe et on le multiplie par le cofacteur du cardinal de la courbe, on calcule cela en $O_{e}(\log(q))$ opérations sur $\mathbb{F}_q$.

Pour construire le $i$ ème niveau on doit tout d'abord calculer l'équation de $E_{-i}$, pour cela on évalue le $\ell$-polynôme modulaire $\phi_{\ell}$ en $j(E_{-(i-1)})$ en $O(\ell^2)$ opérations, on le factorise alors sur $\mathbb{F}_q$ avec $O(M(\ell)\log(\ell q))$ oéprations d'après \cite[Ch.14]{vzGJG03}. Comme on travaille dans le cas particulier d'un graphe de $\ell$-isogénies cyclique ce polynôme n'a que deux racines définies sur $\mathbb{F}_q$: $j(E_{-i})$ et $j(E_{-i+2})$. On sélectionne alors une courbe arbitraire de $j$-invariant: $j(E_{-i})$. Vu que l'on connaît la cardinalité de la courbe alors on calcule un point $P$ d'ordre $\ell$ en $O_{e}(\log(q))$ opérations sur $\mathbb{F}_q$. On calcule alors à l'aide des formules de Vélu l'isogénie $\phi_{-i}$ qui a pour noyau le groupe engendrée par $P$ de cette isogénie on déduit les polynômes $T_{i},Q_{i}$ en $O(M(\ell^i)\log(\ell^i))$ d'après \cite[Algorithme 1]{DeFeo-Doliskani-Schost13}.
\end{proof}

Comme remarqué dans \cite{DeFeo-Doliskani-Schost13} on peut éviter à chaque ajout d'un nouvel étage à la tour d'extension le coût du calcul du $j$-invariant de la courbe isogène en calculant la totalité du cycle juste après avoir trouve une courbe se situant dans un graphe de $\ell$-isogénies cyclique. Pour calculer ce cycle on commence par calculer sur $E_0$ l'isogénie qui a pour noyau la $\ell$ torsion cyclique rationnelle. Pour cela on calcule en $O_e(\log(q))$ opérations sur $\mathbb{F}_q$ un point de $\ell$-torsion rationnel, on calcule alors la courbe image et par conséquent son $j$-invariant en $O(M(\ell))$ opérations sur $\mathbb{F}_q$ en utilisant les formules de Vélu, on répète cette opération jusqu'à retomber sur le $j$-invariant $j(E_0)$, comme vu précédemment on a une borne théorique pour la longueur du cycle de $O(\sqrt{q}\log(q))$. Ainsi on a une complexité totale de $O((M(\ell) + \log(q)) \sqrt{q} \log(q))$, cependant en pratique la longueur du cycle est petite, on peut alors utiliser cette amélioration.


\paragraph{Relèvement et descente}
Les différentes constructions de tours $\ell$-adiques à l'aide de fibrés irréductibles s'appliquent aussi au cas où l'on a $\Phi_{\ell}$ qui se scinde en produits de facteurs irréductibles de degré $1$ et $2$ en plus du cas précédent comme cela est développé plus en détail dans \cite{DeFeo-Doliskani-Schost13}. Ainsi toutes ces constructions à l'aide de fibrés irréductibles ont une structure commune qui nous permet de calculer le relèvement et la descente de la même manière. En rennomant les variables $(X_i,X_{i-1})$ par $(X,Y)$ et les polynômes $(Q_{i-1},Q_{i},T_i)$ par $(R,S,T)$, alors l'extension au niveau $i$ s'écrit:
\begin{equation}
\mathbb{F}_q[Y]/\langle S(Y) \rangle  \quad \textit{et } \quad \mathbb{F}_q[X,Y]/ \langle R(X), T(X,Y) \rangle
\end{equation}
avec $R$ de degré $\ell^{i-1}$ et $S$ de degré $\ell^i$ et $T(X,Y)$ de la forme $f(Y) -Xg(Y)$ avec $\deg(f)=\ell$ et $deg(g)< \ell$ et $ \mathrm{pgcd}(g,f)=1$. En particulier on peut avoir $g=1$. Dans le reste de cette section on considèrera $f,g$ et le degré $\ell$ fixés.

Le relèvement est le passage d'une base bivariée vers une base univariée, cela correspond donc au passage de la base de droite à celle de gauche. La descente est l'opération inverse. En utilisant la forme particulière de $T$ on montre alors qu'on peut réduire ces opérations à la composition et la décomposition de fonctions rationnelles.

\paragraph{Relèvement}
Soit $P$ dans $\mathbb{F}_q[X,Y]$ et $n$ dans $\mathbb{N}$ avec $\deg(P,X)<n$. On définit $P[f,g,n]$ comme étant:
\[
P[f,g,n]=g^{n-1}P(\frac{f}{g},Y)\in \mathbb{F}_q[X,Y].
\]
Si par exemple $P=\sum_{i=0}^{n-1}p_i(Y)X^i$ alors $P[f,g,n]=\sum_{i=0}^{n}p_if^ig^{n-1-i}$. On va donc montrer comment le calculer puis on va relier ce polynôme au relèvement d'éléments de la tour.

\begin{algorithm}
\caption{\label{alg:Compose}Compose}
\begin{algorithmic}[1]
\REQUIRE $P \in \mathbb{F}_q[X,Y], f,g \in \mathbb{F}_q[Y], n \in \mathbb{N}$
\ENSURE $P[f,g,n] \in \mathbb{F}_q[X,Y]$.
\IF{ $n=1$}
 \RETURN $P$
\ELSE
\STATE $m \gets \left\lceil n/2 \right\rceil   $
\STATE Soient $P_0,P_1$ tels que $P=P_0 + X^{m} P_1$
\STATE $Q_0 \gets \textrm{Compose}(P_0,f,g,m))$
\STATE $Q_1 \gets \textrm{Compose}(P_0,f,g,n-m))$
\STATE $Q \gets Q_0g^{n-m}+Q_1f^m$
\RETURN $Q$ 
\ENDIF
\end{algorithmic}
\end{algorithm}


\begin{thm}\label{thm:compose}
Avec les entrées $P,f,g,n$ tels que $\deg(P,X)<n$ et $\deg(P,Y)<\ell$, l'algorithme \ref{alg:Compose} calcule $Q=P[f,g,n]$ avec un coût de $O(M(\ell n)\log(n))$ opérations sur $\mathbb{F}_q$.
\end{thm}

\begin{proof}
Voir \cite{DeFeo-Doliskani-Schost13}.
\end{proof}

\begin{cor}
Au niveau $i$ de la tour d'extension $\ell$-adique, un relèvement coûte $O(M(\ell^i)\log(\ell^i))$ opérations sur $\mathbb{F}_q$
\end{cor}

\begin{proof}
Soit $\alpha$ un élément de $\mathbb{F}_{q^{\ell^i}}$ alors $\alpha$ peut être représenté dans une base bivariée, c'est à dire par un polynôme $A(X,Y)$ avec $\deg(A,X)<n=\ell^{i-1}$ et $\deg(A,Y)<\ell$. On calcule alors à l'aide de l'algorithme \ref{alg:Compose} le polynôme univarié en $Y$ $A^*=A[f,g,n]$ et $\gamma = g^{n-1}$ le tout à l'aide de $O(M(\ell^i)\log(\ell^i))$ opérations dans $\mathbb{F}_q$. Le relevé de $\alpha$ sera alors $A^*/\gamma$ modulo $S$. L'inversion de $\gamma$ coûte $O(M(\ell n)\log(\ell n))$ opérations, et la multiplication ajoute un cout de $O(M(\ell n))$.
\end{proof}

\paragraph{Descente}
On a donc le problème inverse de celui traité dans le théorème \ref{thm:compose} pour faire une descente. On a donc en entrée un polynôme $Q \in \mathbb{F}_q[y]$, on veut alors retrouver $P\in \mathbb{F}_q[X,Y]$ tel que $Q=P[f,g,n]$. 
\begin{algorithm}
\caption{\label{alg:Decompose}Decompose}
\begin{algorithmic}[1]
\REQUIRE $Q,f,g,h \in \mathbb{F}_q[Y], n \in \mathbb{N}$
\ENSURE $P[f,g,n] \in \mathbb{F}_q[X,Y]$.
\IF{ $n=1$}
 \RETURN $Q$
\ELSE
\STATE $m \gets \left\lceil n/2 \right\rceil   $
\STATE $u \gets h^{n-m}=1/g^{n-m} \bmod f^m$
\STATE $Q_0 \gets Qu \bmod f^m$
\STATE $Q_1 \gets (Q-Q_0g^{n-m}) \mathrm{div} f^m$
\STATE $P_0 \gets \textrm{Decompose}(Q_0,f,g,h,m))$
\STATE $P_1 \gets \textrm{Decompose}(Q_1,f,g,h,n-m))$
\RETURN $P_0 + X^mP_1$ 
\ENDIF
\end{algorithmic}
\end{algorithm}

\begin{thm}
Soient $Q,f,g,h,n$ avec $\deg(Q)<\ell n$ et $h=1/g \bmod f$ les entrées de l'algorithme \ref{alg:Decompose}, alors l'algorithme \ref{alg:Decompose} calcule un polynôme $P \in \mathbb{F}_q[X,Y]$ tel que $\deg(P,X)<n$, $\deg(P,Y)<\ell$ et $Q=P[f,g,n]$ avec une complexité de $O(M(\ell n) \log(n))$ opérations sur $\mathbb{F}_q$.
\end{thm}

\begin{proof}
Voir la preuve issue de \cite{DeFeo-Doliskani-Schost13}.
\end{proof}

\begin{cor}
Au $i$ème niveau de la tour, l'opération de descente coûte $O(M(\ell^i)\log(\ell^i))$ opérations sur $\mathbb{F}_q$.
\end{cor}

\begin{proof}
Soit $\alpha$ un élément de $\mathbb{F}_{q^{\ell^i}}$ alors $\alpha$ peut être représenté dans une base univariée sous la forme $A(Y)$ avec $A$ un polynôme de degré strictement inférieur à $\ell n $ avec $n=\ell^{i-1}$. On calcule tout d'abord le polynôme $g^{n-1}$ afin de pouvoir calculer $A^*=g^{n-1}A \bmod S$ le tout avec une complexité de $O(M(\ell^i))$ opérations. On calcule alors le polynôme $h=1/g \bmod f$ avec un coût de $O(M(\ell)\log(\ell))$ opérations sur $\mathbb{F}_q$ et l'on applique alors l'algorithme \ref{alg:Decompose} aux entrées: $A^*,f,g,h,n$. Celui-ci calcule alors un polynôme bivarié $B$ avec une complexité de $O(M(\ell^i\log(\ell^i))$ opérations sur $\mathbb{F}_q$, $B$ représente alors $\alpha$ dans la base bivariée.
\end{proof}


\subsubsection{Remarques sur les utilisations dans notre cas pratique}
On pourra remarquer que dans le cas qui nous intéresse en pratique on choisit comme corps de base pour la tour $\ell$-adique une extension $F_1$ de $\mathbb{F}_q$ dans laquelle on a $E[\ell] \subset E(F_1)$. Pour calculer une telle extension on calcule les ordres des valeurs propres $\lambda, \mu$ de $\pi$ modulo la $\ell$-torsion. On travaille alors avec l'extension $F_1$ de degré $d_1$ avec $d_1=ppcm(o(\lambda),o(\mu))=o(q)$ et $o$ l'ordre multiplicatif dans $\mathbb{Z}/\ell\mathbb{Z}^*$, $d_1$ est en particulier l'ordre de la matrice $\pi$ sur la $\ell$ torsion, il divise $\ell-1$. Une conséquence importante pour l'analyse des constructions possibles de tours $\ell$-adiques c'est que dans ce cas-là on aura $\ell \mid F_1-1$, qui est comme on a vu le cas le plus avantageux pour les opérations dans les tours d'extension. 

Ainsi pour le calcul d'opérations dans de telles tours $\ell$-adiques on devra ajouter un facteur $O(M(\ell)\log(\ell))$ aux résultats obtenus pour une tour $\ell$ adique construite sur un corps $F_1$ tel que $\ell \mid F_1-1$ pour avoir le coût des opérations dans $\mathbb{F}_q$.


\subsubsection{Opérations sur les tours $\ell$-adique}


\paragraph{Calcul du Frobenius}

\chapter{Calcul d'isogénies sur les corps finis}
Dans ce chapitre vont être présentés différents algorithmes pour résoudre le problème suivant: soient $E, E'$ deux courbes elliptiques définies sur $\mathbb{K}$, on cherche alors à calculer la fraction $\mathbb{K}$-rationnelle qui a pour domaine $E(\mathbb{K})$ et pour codomaine $E'(\mathbb{K})$  telle que  cette application  définisse une isogénie.
On va s'intéresser tout particulièrement au cas des corps finis $\mathbb{F}_q$, bien que les algorithmes présentés peuvent s'utiliser sur des corps de caractéristique nulle.

\section{Rappel et applications des formules de Vélu}
Comme vu dans le chapitre \ref{cha:Rappels theoriques} à l'aide des formules de Vélu on peut expliciter une isogénie séparable de degré $\ell$ sous la forme:
\begin{equation} 
\label{eq:velu:gh}
I(x,y)=\left(\frac{g(x)}{h(x)},y\left( \frac{g(x)}{h(x)} \right)'\right)
\end{equation}
avec 
\begin{equation*}
h(x)=\prod_{Q \in G \setminus \{0_E\}}(x-x(Q)),
\end{equation*}
avec $G=\ker(I)$, $g$ un polynôme. On rappelle qu'en plus à l'aide de la reformulation d'Elkies on a:
\begin{equation}
\frac{g(x)}{h(x)}= \deg(I) x -p_1 - f'(x) \frac{h'(x)}{h(x)} -2f(x)  \left(\frac{h'(x)}{h(x)}\right)'
\end{equation}
avec $f$ donné par l'équation de Weierstrass de $E$: $y^2=f(x)$, $p_1$ la somme des abscisses des points du noyau que l'on peut lire sur le coefficient de $x^{\ell-2}$ dans $h$. Ainsi à partir de $h(x)$ on est capable de calculer l'isogénie en $\mathsf{M}(\deg(I))$ opérations sur $\mathbb{F}_q$. On va donc expliciter des algorithmes dans le reste de ce document qui calculent $h$.


Il est important de noter qu'il existe des isogénies de la forme:
\begin{equation}
\label{eq:iso:gen}
I(x,y)=\left( \frac{g(x)}{h(x)},cy\frac{g(x)}{h(x)} \right)
\end{equation}
avec $c \in \overline{\mathbb{F}_q}$. Ainsi on énonce les définitions suivantes:


\begin{defi}
Soit $I$ une isogénie de la forme \ref{eq:iso:gen} avec $c=1$, on dit alors que cette isogénie est \emph{normalisée}. 

Pour deux courbes $\ell$-isogènes exprimées sous forme de Weierstrass telle que l'isogénie associée à ces courbes est une isogénie normale on dit que ces courbes ont des équations de Weierstrass \emph{normalisées}. 
\end{defi}
\section{Elkies 1998}
Ici on va se restreindre au cas où la caractéristique $p$ de $\mathbb{F}_q$ est supérieure ou égale à $5$, en pratique on souhaite $p >> \ell$.
Dans le modèle de Elkies on travaille avec des courbes à équations de Weierstrass normalisées, celles-ci sont calculées à l'aide du $\ell$-ème polynôme modulaire (voir proposition \ref{prop:elk:nor} pour la construction et ?? pour la preuve que cela donne des équations de Weierstrass normalisées \textcolor{red}{ref à mettre plus tard}).
L'idée de Elkies est d'à partir des équations de Weierstrass normalisées de $E:$
\begin{equation}
y^2=x^3+Ax+B
\end{equation}
 et $\tilde{E}:$
\begin{equation}
y^2=x^3+\tilde{A}x+\tilde{B}
\end{equation}
injecter l'équation de l'isogénie \textbf{normalisée}:
\begin{equation} 
\label{eq:velu:gh}
I(x,y)=\left(\frac{g(x)}{h(x)},y\left( \frac{g(x)}{h(x)} \right)'\right) 
\end{equation}
et celle de $E$ dans celle de $E'$:
\begin{equation}
(x^3+Ax+B)\left(\frac{g(x)}{h(x)} \right)'^2=  \left(\frac{g(x)}{h(x)} \right)^3 + \tilde{A} \left(\frac{g(x)}{h(x)} \right) + \tilde{B}.
\end{equation}
Cette équation est alors dérivée pour obtenir une équation différentielle du second ordre:
\begin{equation}
\label{eq:Elkies-deriv}
(3x^2+A)\left(\frac{g(x)}{h(x)} \right)'+2(x^3+Ax+B)\left(\frac{g(x)}{h(x)} \right)''=  3\left(\frac{g(x)}{h(x)} \right)^2 + \tilde{A}
\end{equation}
On écrit alors le développement en série de la fonction rationnelle $\frac{g(x)}{h(x)}$ à l'infini:
\begin{equation}
\label{eq:iso:frac}
\frac{g(x)}{h(x)}=x+ \sum_{i\geqslant 1} \frac{h_i}{x^i}
\end{equation}
que l'on injecte dans \ref{eq:Elkies-deriv} pour trouver des relations de récurrence entre les $h_i$ en identifiant les coefficients des $x^{-i}$:
\begin{equation}
\label{eq:rec:h_k}
h_k=\frac{3}{(k-2)(2k+3)}\sum_{i=1}^{k-2}h_ih_{k-1-i}\frac{2k-3}{2k+3}Ah_{k-2}-\frac{2(k-3)}{2k+3}Bh_{k-3} \quad \text{pour tout } k \geqslant 3,
\end{equation}
les termes $h_1,h_2$ étant déterminés par:
\begin{equation}
h_1=\frac{A-\tilde{A}}{5} \quad h_2={\frac{B-\tilde{B}}{7}}.
\end{equation}
Ainsi, à l'aide de cette récurrence, le coût de calcul de $h_3, \cdots , h_{\ell-2}$ est de $O(\ell^2)$ opérations sur $\mathbb{F}_q$. 

\begin{rem}
\label{rem:ELK:h-p}
On peut ensuite calculer $h(x)$ sans passer par une reconstruction rationnelle, en effet on peut retrouver les sommes de Newton: $p_0,p_1,\cdots, p_n$ à l'aide de la connaissance de $p_0=\ell-1$ et $p_1$. Dans le cas considéré par Elkies il est tout à fait vraisemblable de supposer la connaissance de $p_1$ car le calcul du $\ell$-ème polynôme modulaire $\phi_{\ell}$ a été effectué (voir \ref{sub:Elkies} pour plus de contexte), à l'aide des dérivées partielles de $\phi_{\ell}$. Ensuite avec \ref{eq:iso:frac} on établit la récurrence:
\begin{equation}
\label{eq:p:rec}
h_i=(2i+1)p_{i+1}+(2i-1)Ap_{i-1}+(2i-2)Bp_{i-2}
\end{equation}
à l'aide de laquelle on calcule tous les $p_i$ en $O(\ell)$ opérations sur $\mathbb{F}_q$. Ensuite à l'aide de la remarque \ref{rem:pol:rec} et des sommes de Newton de $h$ on calcule $h$ en $O(\mathsf{M}(\ell))$ opérations sur $\mathbb{F}_q$ par \cite[§2.2]{BMSS08}.
Ensuite à l'aide de $h$ on peut calculer $g$ en $O(\mathsf{M}(\ell))$ opérations sur $\mathbb{F}_q$.
\end{rem}

\begin{rem}
\label{rem:pol:rec}
Soit $P$ un polynôme de degré $d$ défini sur $\mathbb{F}_q[X]$ de caratéristique $p>d$ ou $p=0$. Alors $P$ peut être déterminé à l'aide de la formule:
\begin{equation}
P=\exp\left(\int{\frac{P'}{P}}\right)
\end{equation} 
On a alors à l'aide des sommes de Newton:$p_0=d,p_1, \cdots, p_d$:
\begin{equation}
\frac{P'}{P}= \frac{d}{X} + \sum_{i = 1}^d \frac{p_i}{X^{i+1}}
\end{equation}
Ce qui nous donne:
\begin{equation}
P=\exp\left( d \log(X) - \sum_{i = 1}^{d} \frac{p_i}{i!X^i} \right)
\end{equation} 
Ainsi à l'aide de l'exponentiation et de la connaissance des sommes de Newton on est capable d'exprimer $P$.
\end{rem}
Il est à noter que la condition $p >> \ell$ est là pour nous assurer que $2, \cdots, 2\ell-1$ sont inversibles dans $\mathbb{F}_q$ ce qui permet de pouvoir appliquer la remarque \ref{rem:pol:rec}, ainsi que l'équation \ref{eq:rec:h_k}.
 
\section{BMSS}
L'algorithme BMSS \cite{BMSS08} propose de résoudre le même problème que l'algorihtme de Elkies \cite{elkies1998} et a une meilleure complexité car celui-ci change notamment de méthode pour le calcul des $h_i$:
\begin{thm}
\label{thm:BMSS}
Soient $E, \tilde{E}$ deux courbes ordinaires $\ell$-isogènes sous forme de Weierstrass normalisées, avec $\ell$ différent de $p$ la caractéristique du corps qui peut être nulle ou doit vérifier $p >> \ell$. Alors:
\begin{itemize}
\item  si la somme des abscisses des points du noyau de l'isogénie est connue l'algorithme BMSS calcule l'isogénie qui relie les deux courbes en $O(\mathsf{M}(\ell))$ opérations sur $\mathbb{K}$,
\item si la somme des abscisses des points du noyau de l'isogénie n'est pas connue l'algorithme BMSS calcule l'isogénie qui relie les deux courbes en $O(\mathsf{M}(\ell)\log(\ell))$ opérations sur $\mathbb{K}$.
\end{itemize}
\end{thm}

L'algorithme BMSS part du même postulat que Elkies1998, à savoir, en reprenant les notations de la section précédente, trouver le développement en série de la solution de l'équation différentielle suivante:   
\begin{equation}
\label{eq:BMSS:ED1}
(x^3+Ax+B)\left(\frac{g(x)}{h(x)} \right)'^2=  \left(\frac{g(x)}{h(x)} \right)^3 + \tilde{A} \left(\frac{g(x)}{h(x)} \right) + \tilde{B}.
\end{equation}
Cependant on ne connaît pas des conditions initiales en $0$ pour cette équation différentielle vérifiée par $\frac{g(x)}{h(x)}$ et comme $\deg(g)=\ell> \deg(h)= \ell-1$ alors on ne peut travailler avec des conditions à l'infini. On pose donc:
\begin{equation}
S(x)=\sqrt{\frac{h(1/x^2)}{g(1/x^2)}} \quad \text{équivalent à} \quad \frac{g(x)}{h(x)}=\frac{1}{S(1/\sqrt{x})}
\end{equation} 
avec 
\begin{equation}
S(x)=x + \frac{\tilde{A}-A}{10}x^5+\frac{\tilde{B}-B}{14}x^7+O(x^9)
\end{equation}
L'équation \ref{eq:BMSS:ED1} devient alors:
\begin{equation}
\label{eq:BMSS:ED2}
(1+Ax^4+Bx^6)(S'(x))^2=1+\tilde{A}(S(x))^4+\tilde{B}(S(x))^6
\end{equation}
que l'on reformule à l'aide des fonctions $G(x)=1/(Bx^6+Ax^4+1)$ et $H(t)=\tilde{B}t^6+\tilde{A}t^4+1$. Ainsi \ref{eq:BMSS:ED2} devient 
\begin{equation}
\label{eq:BMSS:ED3}
(S')^2=(H \circ S) G
\end{equation}

Ainsi on va d'abord exposer une solution pour résoudre cette équation différentielle \eqref{eq:BMSS:ED3}, puis on présentera la résolution complète du problème énoncé dans le théorème \ref{thm:BMSS}. 

\begin{lem}
\label{lem:BMSS}
Soient $H(t)=1+\tilde{A}t^4+\tilde{B}t^6$, $G(x)=\frac{1}{1+Ax^4+Bx^6}$ telles que $G(0)H(\alpha)=\beta^2$ alors à partir de $S$ une solution de l'équation différentielle $(S')^2=(H \circ S) G$ définie modulo $x^{d+1}$ avec $S(0)=\alpha$ et $S'(0)=\beta$, une solution de cette même équation définie modulo $x^{2d}$ peut être calculée à l'aide de l'algorithme \ref{alg:BMSS:eqdiff} en utilisant $O(\mathsf{M}(2^d))$ opérations sur $\mathbb{F}_q$.
\end{lem}

\begin{proof}
La preuve complète est donnée dans \cite{Lercier-Sirvent2008} la principale différence par rapport à \cite{BMSS08} est que la résolution de l'équation différentielle linéaire issue de \eqref{eq:BMSS:ED3} est faite à l'aide d'un calcul de racine carrée et non plus d'une exponentiation comme dans \cite{BMSS08}. 
On va donc présenter l'idée pour accroître la précision d'une solution de \eqref{eq:BMSS:ED3} et donc démontrer partiellement le lemme \ref{lem:BMSS}.

Soit $f_1$ une solution de \eqref{eq:BMSS:ED3} modulo $x^{d+1}$ et $f_2$ telle que:
\begin{equation}
S=f_1+f_2 \bmod x^{2d+1}
\end{equation}
avec $x^{d+1}$ qui divise $f_2$. On a alors $x^{2d}$ qui divise $f_2'^2$ et on obtient par \eqref{eq:BMSS:ED3}:
\begin{equation}
\label{eq:BMSS:ED4}
2f_1'f_2'+f_1'^2=G(x)H(f_1+f_2) \bmod x^{2d}
\end{equation}
On fait le développement de Taylor de $H$ en $f_1$, on obtient l'équation différentielle linéaire:
\begin{equation}
2f_1'f_2'+f_1'^2=G(x)H(f_1)+G(x)H'(f_1)f_2 \bmod x^{2d}
\end{equation}
avec la condition initiale $f_2(0)=0$. Que l'on peut reformuler:
\begin{equation}
\label{eq:LS08:diflin}
f'_2-\frac{G(x)H'(f_1)}{2f'_1}f_2=\frac{G(x)H(f'_1)-f'_1^2}{2f'_1}
\end{equation}

 Cette équation a alors pour solution:
\begin{equation}
f_2=\frac{1}{J}\int \frac{(G(x)H(f_1)-f_1'^2)J}{2f_1'} dx,
\end{equation}
avec 
\begin{equation}
J=\exp \left( -\int \frac{G(x)H'(f_1)}{2f_1'}dx \right).
\end{equation}
Il est à noter que comme on souhaite uniquement calculer une solution à précision $x^{2d+1}$, on a besoin uniquement de calculer $J$ et son inverse à précision $x^d$.
Comme $f_1'$ est une solution de \eqref{eq:BMSS:ED3} alors on peut réexprimer $f_1'$ à l'aide de celle-ci et obtenir:
\begin{equation}
\frac{G(x)H'(f_1)}{2f_1'}=\frac{H'(f_1)f_1'}{2H(f_1)} \bmod x^d,
\end{equation}
ainsi 
\begin{equation}
J=\exp \left(-\frac{1}{2}\log H(f_1) \right)= \frac{1}{\sqrt{H(f_1)}}.
\end{equation}
Ainsi à chaque nouvelle itération pour résoudre \eqref{eq:BMSS:ED3} on a uniquement besoin de calculer les quantités suivantes:
\begin{equation}
S, \quad U=1/S', \quad V=\sqrt{H \circ S}, \quad J=1/V.
\end{equation}
\'A chaque itération de ces calculs effectués on double la précision de ces quantités à l'aide d'une itération de Newton. Les uniques opérations effectuées étant des inversions et des multiplications de séries alors la $i$-ème itération coûte $O(\mathsf{M}(2^i))$ opérations sur $\mathbb{F}_q$, et donc par la superlinéarité de $\mathsf{M}$, l'algorithme a la même complexité que la dernière itération. 
\end{proof}


\begin{algorithm}
\caption{\label{alg:BMSS:eqdiff} Résolution d'équation différentielle}
\begin{algorithmic}[1]
\REQUIRE $d>1, \alpha \in \mathbb{F}_q, \beta \in \mathbb{F}_q^*, H \in \mathbb{F}_q[t], G \in \mathbb{F}_{q}[[x]]$ ,%\\
\ENSURE $S \in \mathbb{F}_q[x]$ solution de $S'^2=(H \circ S)G \bmod x^{2d}$
\STATE Soient $U \gets 1/\beta + O(x), J \gets 1/\sqrt{H(\alpha)}+O(x), V \gets \sqrt{H(\alpha)} + O(x)$
\STATE Soit $S \gets \alpha + \beta x + \frac{G'(0)H(\alpha)+G(0)H'(\alpha)\beta}{4\beta}x^2+O(x^3)$;
\FOR {$i \in {2, \cdots , 2^{d-1}}$}
\STATE $U \gets U(2-S'U) \bmod x^{2i}$
\STATE $V \gets (V+(H \circ S)J(2-VJ))/2 \bmod x^{i}$
\STATE $J \gets J(2-VJ) \bmod {x^i}$
\STATE $S \gets S+V \int ((H \circ S)G-S'^2)UJ/2 \bmod x^{2i+1}$
\ENDFOR
\RETURN$S$. 
\end{algorithmic}
\end{algorithm}

Une solution $S$ de l'équation différentielle \eqref{eq:BMSS:ED3} est calculée à précision $x^{4\ell}$ à l'aide de l'algorithme \ref{alg:BMSS:eqdiff}. On définit les valeurs suivantes:
\begin{equation}
S(x)=xT(x^2), \quad R(x)=\frac{1}{T(x)^2} \quad \text{tel que } \frac{g(x)}{h(x)}=xR(1/x)
\end{equation}
que l'on détermine successivement dans l'algorithme \ref{alg:BMSS:total}. La dernière étape de \ref{alg:BMSS:total} est une reconstruction rationnelle (\textcolor{red}{mettre référence}).

\begin{algorithm}
\caption{\label{alg:BMSS:total} BMSS}
\begin{algorithmic}[1]
\REQUIRE $\ell>1$, deux courbes $\ell$-normalizées  ,%\\
\ENSURE La fraction rationnelle $\frac{g(x)}{h(x)}$ qui représente la $\ell$-isogénie
\STATE Calculer $G(x)=1/(1+Ax^4+Bx^6) \bmod x^{4\ell-1}$.
\STATE Calculer $S(x)$ $\bmod x^{4\ell-1}$ à l'aide de l'algorithme \ref{alg:BMSS:eqdiff}.
\STATE Soit $T(x)=\sum_{i=0}^{2\ell-1}s_{2i+1}x^i$.
\STATE Calculer $R(x)=1/T(x)^2 \bmod(x^{2\ell-1})$.
\STATE Calculer $\frac{g(x)}{h(x)}$ à l'aide de reconstruction rationnelle. 
\end{algorithmic}
\end{algorithm}

\begin{rem}
Il est à noter que si $p_1$ est connu alors on peut effectuer la reconstruction rationnelle comme précisé dans les remarques \ref{rem:ELK:h-p} \ref{rem:pol:rec} et ainsi il est suffisant de calculer $S$ à précision $x^{2\ell}$ 
\end{rem}

\begin{rem}
L'algorithme BMSS impose le fait d'avoir $p>>\ell$ car à l'étape $7$ de $\ref{alg:BMSS:eqdiff}$ une intégration est nécessaire ce qui entraîne des divisions pas les entiers compris entre $1$ et $2\ell$ lorsque $p_1$ est connu, entre $1$ et $4\ell-1$ sinon. Cela pose donc des limites aux applications de BMSS.
\end{rem}




%on peut alors énoncer les algorithmes qui solutionnent le théorème \ref{thm:BMSS}.
%On commence avec l'algorithme qui suppose la connnaissance de $p_1$
%\begin{enumerate}
%\item Calculer $G(x) \bmod x^{2\ell-1}$ en utilisant \cite[§2.1]{BMSS08} 
%\item Calculer $S(x)$ solution de \eqref{eq:BMSS:ED3} modulo $x^{2\ell}$ en utilisant \cite[§2.4]{BMSS08}, puis en déduire $T$.
%\item Calculer $R=\frac{1}{T^2}$ à l'aide de \cite[§2.1]{BMSS08}
%\item En déduire $\frac{g(x)}{h(x)}$
%\item Calculer $h$ à l'aide des relations de récurrence de \ref{eq:p:rec} et de l'algorithme d'exponentiation rapide \cite[2.2]{BMSS08}
%\item En deduire $g$ à l'aide de \eqref{eq:iso:frac}
%\end{enumerate}
%Sans la connaissance de $p_1$ l'algorithme va être obligé d'utiliser une reconstruction rationnelle avec des algorithmes tels que celui de Berlekamp-Massey:
%\begin{enumerate}
%\item Calculer $G(x) \bmod x^{2\ell-1}$ en utilisant \cite[§2.1]{BMSS08} 
%\item Calculer $S(x)$ solution de  \eqref{eq:BMSS:ED3} modulo $x^{2\ell}$ en utilisant \cite[§2.4]{BMSS08}
%\item En déduire $T$, puis calculer $T(x)^2$.
%\item Calculer $R$ à l'aide de \cite[§2.1]{BMSS08}
%\item En déduire le développement $h_1, \cdots h_{\ell}$ de $\frac{g(x)}{h(x)}$
%\item Calculer $h$ et $g$ à l'aide d'un algorithme de reconstruction rationnelle.
%\end{enumerate}


\section{Algorithme de Lercier Sirvent (+ resultat de Tristan)}
L'algorithme de Lercier Sirvent répond à la problématique posée par le fait que BMSS ne peut pas s'utiliser sur des corps de petite caractéristique à cause de possibles division par $0$, une solution naturelle envisagée est donc de résoudre ce problème en travaillant dans les entiers entiers $p$-adiques.

Ainsi l'algorithme de Lercier Sirvent transpose l'algorithme BMSS dans les nombres $p$-adiques et spécifie quelle précision on a besoin sur les entrées de l'algorithme. On présente tout d'abord l'algorithme de lercier Sirvent \ref{alg:LS08:modified}. 

Celui-ci calcule un relevé $\overline{E}$ de $E$ dans $\mathbb{Q}_p$, l'algorithme calcule un relèvement$\overline{j_{E''}}$ du $j$-invariant $j'$ de la courbe $\ell$-isogène $E'$. Ensuite les formules de Elkies \cite{elkies1998} sont utilisées afin  de calculer une équation de Weierstrass normalisée de $\overline{E''}$, codomaine de $\overline{I}$. L'algorithme BMSS \cite{BMSS08} est utilisé pour calculer l'isogénie $\overline{I}:\overline{E} \rightarrow \overline{E''}$ on réduit alors celle-ci et $\overline{E'}$ ensuite, enfin on calcule $I: E \rightarrow E $ à l'aide de l'isomorphisme $E' \equiv E''$. 

\begin{algorithm}
\caption{\label{alg:LS08:modified} Algorithme de Lercier-Sirvent}
\begin{algorithmic}[1]
\REQUIRE $E,E'$ two ordinary elliptic $\ell$-isogenous ,%\\
\ENSURE $I$ an $\ell$-isogeny such that $I:E \rightarrow E'$
\STATE Calculer un relevément de l'équation de Weierstrass de $E$ dans $\mathbb{Q}_p$
\STATE Calculer un relevé $\overline{j_{E'}}$ de la solution de $\phi_{\ell}(X,j_E)$ dans $\mathbb{Q}_p$ à partir de $j_{E'}$
\STATE Calculer une equation de Weierstrass normalisée de $\overline{E''}$ de $j$-invariant $\overline{j_{E'}}$ à l'aide des formules de Elkies
\STATE Utiliser l'algorithme BMSS pour calculer l'isogénie $\overline{I}$
\STATE Réduire modulo $p$ $\overline{E''}$ et $\overline{I}$ vers $E''$ et $I$
\STATE Utiliser l'isomorphisme:$E' \rightarrow E''$ pour calculer l'isogénie $I: E \rightarrow E'$.
\RETURN$S$. 
\end{algorithmic}
\end{algorithm}

\begin{prop}[Lairez-Vaccon]
Soient deux courbes $\ell$-isogènes $E,E'$ en entrée et $p \geqslant 5$ l'algorithme \ref{alg:LS08:modified} calcule l'isogénie normalisée que relie $E$ à $E'$ à l'aide d'une précision d'au plus $ 1 + \lfloor \log_p(4 \ell - 1) \rfloor $ nombres p-adiques 
\end{prop}

Ce résultat issu de \cite{LairezVaccon16} est une amélioration du résultat original de Lercier Sirvent \cite{Lercier-Sirvent2008}. Cette amélioration porte notamment sur la précision de la solution de l'équation différentielle que l'on doit résoudre à l'étape 2 de l'algorithme BMSS \ref{alg:BMSS:total}.

\begin{proof}
Une preuve détaillée est donnée dans \cite{LairezVaccon16}.
En effet on a besoin de calculer une solution de l'équation différentielle linéaire \ref{eq:LS08:diflin} de précision $4\ell-1$ si l'on ne connaît pas la somme des abscisses des points du noyau de l'isogénie. Ainsi dans ce cas qui nous intéresse on applique le résultat de Lairez Vaccon: pour obtenir une solution $p$-adique de précision $4 \ell-1$ on a besoin d'avoir en entrée des éléments de précision $ 1 + \lfloor \log_p(4 \ell - 1) \rfloor $.
\end{proof}
\begin{thm}
L'algorithme utilise 
\end{thm}



\subsection{Algorithme de Couveignes (parler de ses variantes)}

\subsection{Volcans d'isogénies}
\subsection{Travaux de Kohel, Fouquet-Morain}
Mettre l'algorithme de Fouquet Morain
\subsection{Travaux de Miret \& Al. et Ionica-Joux}


\section{Frobenius et ses applications sur un volcan d'isogénies}
\subsection{Base diagonale, horizontale}
% A retravailler
Mais avant de parler de ces algorithmes regardons plus en détail l'amélioration de S.E.A. pour le cas Elkies qui a été proposé par Couveignes et Morain \cite{Couveignes96isogenycycles} celle-ci propose en effet de déterminer $t_{\pi} \bmod \ell^k$ en utilisant les cycles d'isogénies. 

\subsubsection{Amélioration du cas Elkies par Couveignes et Morain}
Comme dit dans \ref{sub:Elkies} l'étape la plus importante pour le coût de l'algorithme est de déterminer un polynôme de Elkies qui définisse un espace propre pour le Frobenius pour lequel on va ensuite déterminer la valeur propre associée. L'algorithme de Couveignes et Morain propose alors de déterminer ces espaces prorpres pour la $\ell^k$ torsion en itérant le procédé sur un cycle d'isogénies.

En effet comme on est dans le cas Elkies alors la courbe $E_0$ dont on veut calculer le cardinal admet deux  courbes $\ell$-isogènes définies dans $\mathbb{F}_q$. Ainsi pour ces courbes isogènes le polynôme modulaire admet aussi deux solutions  dans $\mathbb{F}_q$. En effet ces courbes sont de même cardinal que $E_0$ et ont donc la même valeur $t_{\pi}$, par conséquent le fait que $t_{\pi}^2-4q$ soit un résidu quadratique modulo $\ell$ reste préservé. Ainsi chaque courbe admet deux coubes isogènes définies sur $\mathbb{F}_q$, on définit alors un cycle qui est fini. En effet à chaque courbe on peut associer à isomorphisme près un ordre maximal pour l'indice $\ell$ (\textcolor{red}{ref a mettre plus tard}) dans $\mathbb{Q}[X]/(X^2-t_{\pi})X+q$ or comme le nombre de classe est borné on obtient le résultat. 

L'idée derrière cet article est donc de décomposer en deux espaces propres la $\ell^k$ torsion à l'aide des valeurs propres du Frobenius dans le cas Elkies, puis de calculer la valeur de la trace du Frobenius ($t_{\pi}$) dans ces espaces propres. Ainsi la recherche de la valeur de $t_{\pi}$ se fera sur des ensembles plus petits et donc en manipulant des polynômes de degré moindre. Pour décrire tout cela il est nécessaire de poser quelques notations. On généralise tout d'abord l'action du Frobenius $\pi$ sur $E[\ell]$ à une action sur $T_{\ell}(E)$, on a alors une décomposition de $T_{\ell}(E)$ en deux espaces propres: $T_{\ell}^{\lambda}(E) \oplus T_{\ell}^{\mu}(E)$, avec $T_{\ell}^{\lambda}(E)$ associé à la valeur propre $\lambda$ et $T_{\ell}^{\mu}(E)$ associé à la valeur propre $\mu$. 


Montrons tout d'abord que les isogénies peuvent êtres associées de façon canonique aux valeurs propres du Frobenius. On note $I_{\lambda}$ (resp. $I_{\mu}$) l'isogénie engendrée par l'espace propre pour $\pi$ associé à la valeur propre $\lambda$ (resp. $\mu$). Ainsi en partant de $E_0$ on note alors $E_{\lambda}$(resp. $E_{\mu}$) l'image de l'isogénie $I_{\lambda}$ (resp. $I_{\mu}$). Lorsque l'on est sur $E_{\lambda}$ on a alors à nouveau l'existence de deux isogénies associées aux deux espaces propres: $I_{\lambda \lambda}$ pour l'iosgénie associée à la valeur propre $\lambda$ et $I_{\lambda \mu}$ pour l'isogénie associée à la valeur propre $\mu$. On a alors $I_{\lambda \mu}=\widehat{I_{\lambda}}$, en effet l'isogénie $I_{\lambda}$ étant rationnelle sa duale l'est aussi et on conclut alors en analysant son action sur $T_{\ell}^{\lambda}(E)$. Ainsi on a des directions canoniques définies par les valeurs propres $\lambda$ et $\mu$. 

Il reste alors à montrer comment on détermine en pratique un espace propre de la $\ell^k$ torsion. Travaillons donc avec l'espace propre associé à $E_{\lambda}$, on a alors $T_{\ell}^{\lambda}(E_0) \cap E_0[\ell]$ qui est contruit comme étant le noyau de l'isogénie qui va de $E_0$ à $E_{\lambda}$. Pour calculer celui-ci on doit tout d'abord calculer à l'aide du polynôme modulaire les $j$-invariants des deux courbes $E_0$ et $E_1$, puis leur représentations sous forme de Weierstrass, puis l'isogénie est ensuite calculée. Ainsi on dénote $h_1$ le polynôme qui s'annule sur l'abscisse des points du noyau de l'isogénie $I_1$. 
Maintenant si l'on veut déterminer $T_{\ell}^{\lambda}(E_0) \cap E[\ell^2]$, on remarque que cet ensemble c'est la préimage du noyau de l'isogénie $I_{\lambda \lambda}$ (id est $h_{\lambda \lambda}$) par l'isogénie $I_{\lambda}$. Ainsi on injecte $I_{\lambda}$ dans $h_{\lambda \lambda}$ pour obtenir cet ensemble qui est donc le noyau de $h_{\lambda \lambda}(I_{\lambda}(x))$. On répète alors l'opération pour déterminer un espace propre pour le Frobenius de la $\ell^k$-torsion. Ainsi pour la $\ell^k$-torsion on va déterminer l'espace propre par un polynôme de degré $\ell^k  (\frac{\ell-1}{2})$ qui factorise le $\ell^k$-ème polynôme de division de degré $\ell^{2k}$.

On peut alors dès lors résoudre l'équation:
\begin{equation*}
X^2-t_{\pi}X+q=0
\end{equation*}
modulo l'espace propre $T_{\ell}^{\lambda}(E_0) \cap E[\ell^k]$ (ou $T_{\ell}^{\mu}(E_0) \cap E[\ell^k]$ par exemple) défini par un polynôme de degré $\ell^k  (\frac{\ell-1}{2})$ au lieu de résoudre celle-ci modulo $E[\ell^k]$ défini par un polynôme de degré $\ell^{2k}$.

\paragraph{Optimisation}
Cependant on peut travailler aussi avec un facteur de $h_{\lambda^k}$ à la place de celui-ci en effet on peut procéder de la manière suivante:
\begin{itemize}
\item Calcul des deux valeurs propres $\lambda$ et $\mu$ du Frobenius modulo $\ell$,
\item Calcul des ordres multiplicatifs $d_{\lambda},d_{\mu}$ de ces deux valeurs propres dans le groupe multiplicatif $(\mathbb{Z}/\ell \mathbb{Z})^{\times}$,
\item On pose alors $d=\min(d_{\lambda},d_{\mu})$, on divise éventuellement $d$ par $2$ si il est pair pour prendre en compte les abscisses, l'espace vectoriel associé à $d$ est alors défini sur $\mathbb{F}_p^{d}$ et l'on a alors le polynôme de $\ell$-division qui a pour facteur un polynôme de degré $d$. Après avoir factorisé le polynôme de $\ell$-division par un facteur de degré $d$, on utilise alors celui-ci à la place de $h_{\lambda^{k}}$, de telle sorte que lorsque l'on veut calculer la trace du Frobenius modulo un espace propre de la $\ell^k$ torsion on travaille avec un polynôme de degré $d \ell^{k-1}$ et non $(\ell -1)/2 \ell^{k-1}$.
\end{itemize}

Ainsi on a vu une façon de déterminer un espace propre de la $\ell^k$-torsion, à l'aide d'un cycle d'isogénies, et d'exploiter au mieux les nombres de Elkies dans l'algorithme S.E.A. 

%Comme il est remarqué dans l'article original on peut aussi travailler sur une extension de corps dans laquelle les points de $\ell$-torsion issus de l'espace propre sont définis, pour trouver le degré de celle-ci il faut calculer l'ordre multiplicatif des valeurs propres du frobenius dans $(\mathbb{Z}/\ell \mathbb{Z})^{\times}$ et travailler alors avec la valeur propre qui a l'ordre le plus petit afin de travailler dans le corps le plus petit.  Ensuite pour travailler avec de la $\ell^k$ torsion on est obligé travailler dans une extension de degré $d\ell^{k-1}$.
\subsection{Orbites selon le Frobenius}
\subsection{Amélioration de l'algorithme de Couveignes}

\section{Améliorations éventuelles à l'aide du pairing}

\bibliographystyle{plain}
\bibliography{Biblio}
\end{document}
